<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>База знаний | Сойка</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0055a5; --primary-dark: #003d7a; --primary-light: #e6f0ff;
            --secondary: #f8f9fa; --accent: #ff6600; --text: #333; --text-light: #666;
            --border: #dde1e6; --success: #28a745; --warning: #ffc107; --danger: #dc3545;
            --gray: #6c757d; --shadow: 0 4px 12px rgba(0,0,0,0.08); --radius: 12px;
        }
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter', sans-serif; }
        body { background:#f5f7fa; color:var(--text); line-height:1.6; }
        .header { background:linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color:white; padding:1.2rem 2rem; box-shadow:var(--shadow); position:sticky; top:0; z-index:1000; }
        .header-container { max-width:1400px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:1.5rem; }
        .logo { display:flex; align-items:center; gap:1rem; }
        .logo-icon { font-size:2.2rem; color:white; }
        .logo-text h1 { font-size:1.8rem; font-weight:700; }
        .logo-text p { font-size:0.95rem; opacity:0.9; margin-top:0.2rem; }
        .nav { display:flex; gap:0.5rem; flex-wrap:wrap; }
        .nav-btn { background:rgba(255,255,255,0.15); color:white; border:none; padding:0.7rem 1.5rem; border-radius:30px; font-weight:500; cursor:pointer; transition:all 0.3s; display:flex; align-items:center; gap:0.5rem; }
        .nav-btn:hover { background:rgba(255,255,255,0.25); }
        .nav-btn.active { background:white; color:var(--primary); }
        .container { max-width:1400px; margin:2rem auto; padding:0 2rem; }
        .control-panel { background:white; border-radius:var(--radius); padding:2rem; margin-bottom:2rem; box-shadow:var(--shadow); border:1px solid var(--border); }
        .search-container { position:relative; margin-bottom:1.5rem; }
        .search-icon { position:absolute; left:1.2rem; top:50%; transform:translateY(-50%); color:var(--gray); }
        .search-input { width:100%; padding:1rem 1rem 1rem 3.5rem; border:2px solid var(--border); border-radius:10px; font-size:1rem; transition:all 0.3s; }
        .search-input:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(0,85,165,0.1); }
        .filters-row { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:1.5rem; margin-bottom:1.5rem; }
        .filter-group { display:flex; flex-direction:column; gap:0.5rem; }
        .filter-label { font-size:0.9rem; font-weight:500; color:var(--text-light); }
        .filter-select { padding:0.8rem; border:1px solid var(--border); border-radius:8px; background:white; font-size:0.95rem; cursor:pointer; }
        .actions-row { display:flex; gap:1rem; flex-wrap:wrap; }
        .btn { padding:0.8rem 1.5rem; border:none; border-radius:8px; font-weight:500; font-size:0.95rem; cursor:pointer; transition:all 0.3s; display:flex; align-items:center; gap:0.5rem; }
        .btn-primary { background:var(--primary); color:white; }
        .btn-primary:hover { background:var(--primary-dark); transform:translateY(-2px); }
        .btn-success { background:var(--success); color:white; }
        .btn-warning { background:var(--warning); color:#333; }
        .btn-danger { background:var(--danger); color:white; }
        .btn-outline { background:transparent; border:1px solid var(--border); color:var(--primary); }
        .content-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(350px, 1fr)); gap:1.5rem; margin-bottom:3rem; }
        .card { background:white; border-radius:var(--radius); overflow:hidden; box-shadow:var(--shadow); border:1px solid var(--border); transition:all 0.3s; }
        .card:hover { transform:translateY(-5px); box-shadow:0 10px 25px rgba(0,0,0,0.12); }
        .script-card:hover { border-color:var(--primary); }
        .router-card:hover { border-color:var(--accent); }
        .setup-card:hover { border-color:var(--success); }
        .card-header { padding:1.2rem; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; }
        .script-header { background:var(--primary-light); }
        .router-header { background:linear-gradient(90deg, var(--primary-light) 0%, #e6f0ff 100%); }
        .setup-header { background:linear-gradient(90deg, #e6f7ff 0%, #f0f9ff 100%); }
        .card-model, .card-brand { font-weight:600; font-size:1.1rem; color:var(--primary-dark); }
        .card-badge, .router-price, .setup-badge { padding:0.3rem 0.8rem; color:white; border-radius:20px; font-size:0.8rem; font-weight:500; }
        .card-badge, .setup-badge { background:var(--primary); }
        .router-price { background:var(--accent); font-size:0.9rem; font-weight:600; padding:0.4rem 1rem; }
        .card-content { padding:1.5rem; max-height:200px; overflow-y:auto; }
        .script-content { max-height:200px; }
        .router-content { max-height:300px; }
        .setup-content { max-height:300px; }
        .script-text { line-height:1.6; margin-bottom:1rem; }
        .script-tags { display:flex; flex-wrap:wrap; gap:0.5rem; margin-top:1rem; }
        .tag { background:var(--primary-light); padding:0.3rem 0.7rem; border-radius:4px; font-size:0.8rem; color:var(--primary-dark); }
        .router-specs, .setup-steps { list-style:none; margin:1rem 0; }
        .router-specs li { padding:0.5rem 0; border-bottom:1px dashed var(--border); display:flex; justify-content:space-between; }
        .router-specs li:last-child { border-bottom:none; }
        .spec-label { color:var(--text-light); }
        .spec-value { font-weight:500; color:var(--text); }
        .setup-steps li { padding:0.8rem 0; border-bottom:1px dashed var(--border); display:flex; align-items:flex-start; gap:0.8rem; }
        .setup-steps li:last-child { border-bottom:none; }
        .step-number { background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.8rem; font-weight:600; flex-shrink:0; margin-top:0.2rem; }
        .step-text { flex:1; }
        .step-title { font-weight:600; color:var(--primary); margin-bottom:0.3rem; }
        .card-actions { padding:1rem 1.5rem; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:0.8rem; }
        .icon-btn { width:36px; height:36px; border-radius:50%; border:none; background:transparent; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.3s; color:var(--gray); }
        .icon-btn:hover { background:var(--primary-light); color:var(--primary); transform:scale(1.1); }
        .icon-btn.copy:hover { color:var(--success); }
        .icon-btn.edit:hover { color:var(--warning); }
        .icon-btn.delete:hover { color:var(--danger); }
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000; align-items:center; justify-content:center; padding:1rem; }
        .modal-content { background:white; border-radius:var(--radius); width:100%; max-width:700px; max-height:90vh; overflow-y:auto; animation:modalSlide 0.3s ease; }
        @keyframes modalSlide { from { opacity:0; transform:translateY(-30px); } to { opacity:1; transform:translateY(0); } }
        .modal-header { padding:1.5rem 2rem; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; }
        .modal-title { font-size:1.3rem; font-weight:600; color:var(--primary); }
        .modal-close { background:none; border:none; font-size:1.5rem; cursor:pointer; color:var(--gray); }
        .modal-body { padding:2rem; }
        .form-group { margin-bottom:1.5rem; }
        .form-label { display:block; margin-bottom:0.5rem; font-weight:500; color:var(--primary); }
        .form-input, .form-select, .form-textarea { width:100%; padding:0.9rem; border:1px solid var(--border); border-radius:8px; font-size:0.95rem; transition:all 0.3s; }
        .form-textarea { min-height:150px; resize:vertical; line-height:1.5; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(0,85,165,0.1); }
        .form-hint { font-size:0.85rem; color:var(--gray); margin-top:0.3rem; }
        .modal-footer { padding:1.5rem 2rem; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:1rem; }
        .notification { position:fixed; top:20px; right:20px; padding:1rem 1.5rem; background:var(--success); color:white; border-radius:8px; box-shadow:var(--shadow); display:none; z-index:3000; animation:slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity:0; transform:translateX(100px); } to { opacity:1; transform:translateX(0); } }
        .empty-state { text-align:center; padding:4rem 2rem; color:var(--gray); grid-column:1/-1; }
        .empty-icon { font-size:4rem; margin-bottom:1rem; color:#ddd; }
        .section { display:none; }
        .section.active { display:block; }
        @media (max-width:768px) {
            .header-container { flex-direction:column; gap:1rem; text-align:center; }
            .nav { width:100%; justify-content:center; }
            .content-grid { grid-template-columns:1fr; }
            .filters-row { grid-template-columns:1fr; }
            .modal-content { max-height:95vh; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-wifi"></i></div>
                <div class="logo-text">
                    <h1>Сойка | База знаний</h1>
                    <p>Интернет-провайдер • Настройка роутеров • Скрипты поддержки</p>
                </div>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-section="scripts"><i class="fas fa-file-alt"></i> Скрипты</button>
                <button class="nav-btn" data-section="routers"><i class="fas fa-router"></i> Роутеры</button>
                <button class="nav-btn" data-section="setups"><i class="fas fa-cogs"></i> Настройки</button>
                <button class="nav-btn" data-section="stats"><i class="fas fa-chart-bar"></i> Статистика</button>
                <button class="nav-btn" onclick="openModal()"><i class="fas fa-plus"></i> Добавить</button>
            </nav>
        </div>
    </header>
    <main class="container">
        <section id="scripts" class="section active">
            <div class="control-panel">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchScripts" placeholder="Поиск по скриптам...">
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label">Модель роутера</label>
                        <select class="filter-select" id="filterScriptModel">
                            <option value="">Все модели</option>
                            <option value="Tenda TX 2 PRO">Tenda TX 2 PRO</option>
                            <option value="Tenda AC8">Tenda AC8</option>
                            <option value="Tenda AC5">Tenda AC5</option>
                            <option value="TP Link WR850N">TP Link WR850N</option>
                            <option value="Общий скрипт">Общий скрипт</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Категория</label>
                        <select class="filter-select" id="filterScriptCategory">
                            <option value="">Все категории</option>
                            <option value="Диагностика">Диагностика</option>
                            <option value="Настройка">Настройка</option>
                            <option value="Проблемы">Проблемы сети</option>
                            <option value="Баланс">Баланс и платежи</option>
                            <option value="Техработы">Технические работы</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Тип подключения</label>
                        <select class="filter-select" id="filterScriptType">
                            <option value="">Все типы</option>
                            <option value="Динамический">Динамический</option>
                            <option value="PPPoE">PPPoE</option>
                            <option value="Статический">Статический IP</option>
                        </select>
                    </div>
                </div>
                <div class="actions-row">
                    <button class="btn btn-primary" onclick="openModal('script')"><i class="fas fa-plus"></i> Добавить скрипт</button>
                    <button class="btn btn-success" onclick="exportScripts()"><i class="fas fa-download"></i> Экспорт скриптов</button>
                    <button class="btn btn-outline" onclick="clearFilters()"><i class="fas fa-filter"></i> Сбросить фильтры</button>
                </div>
            </div>
            <div class="content-grid" id="scriptsContainer"></div>
        </section>
        <section id="routers" class="section">
            <div class="control-panel">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchRouters" placeholder="Поиск по роутерам...">
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label">Производитель</label>
                        <select class="filter-select" id="filterRouterBrand">
                            <option value="">Все производители</option>
                            <option value="Tenda">Tenda</option>
                            <option value="TP-Link">TP-Link</option>
                            <option value="D-Link">D-Link</option>
                            <option value="Asus">Asus</option>
                            <option value="Huawei">Huawei</option>
                            <option value="Xiaomi">Xiaomi</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Диапазон Wi-Fi</label>
                        <select class="filter-select" id="filterRouterBand">
                            <option value="">Все диапазоны</option>
                            <option value="2.4 ГГц">2.4 ГГц</option>
                            <option value="5 ГГц">5 ГГц</option>
                            <option value="Двухдиапазонный">Двухдиапазонный</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Цена</label>
                        <select class="filter-select" id="filterRouterPrice">
                            <option value="">Любая цена</option>
                            <option value="до 3000">до 3000 руб</option>
                            <option value="3000-5000">3000-5000 руб</option>
                            <option value="от 5000">от 5000 руб</option>
                        </select>
                    </div>
                </div>
                <div class="actions-row">
                    <button class="btn btn-primary" onclick="openModal('router')"><i class="fas fa-plus"></i> Добавить роутер</button>
                    <button class="btn btn-success" onclick="exportRouters()"><i class="fas fa-download"></i> Экспорт роутеров</button>
                </div>
            </div>
            <div class="content-grid" id="routersContainer"></div>
        </section>
        <section id="setups" class="section">
            <div class="control-panel">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchSetups" placeholder="Поиск по настройкам...">
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label">Производитель</label>
                        <select class="filter-select" id="filterSetupBrand">
                            <option value="">Все производители</option>
                            <option value="Tenda">Tenda</option>
                            <option value="TP-Link">TP-Link</option>
                            <option value="D-Link">D-Link</option>
                            <option value="Asus">Asus</option>
                            <option value="Huawei">Huawei</option>
                            <option value="Xiaomi">Xiaomi</option>
                            <option value="Keenetic">Keenetic</option>
                            <option value="Mercusys">Mercusys</option>
                            <option value="Qtech">Qtech</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Тип подключения</label>
                        <select class="filter-select" id="filterSetupType">
                            <option value="">Все типы</option>
                            <option value="Динамический">Динамический IP</option>
                            <option value="PPPoE">PPPoE</option>
                            <option value="Статический">Статический IP</option>
                        </select>
                    </div>
                </div>
                <div class="actions-row">
                    <button class="btn btn-primary" onclick="openModal('setup')"><i class="fas fa-plus"></i> Добавить настройку</button>
                </div>
            </div>
            <div class="content-grid" id="setupsContainer"></div>
        </section>
        <section id="stats" class="section">
            <div class="control-panel">
                <h2 style="margin-bottom:1.5rem;color:var(--primary)">Статистика базы знаний</h2>
                <div class="filters-row">
                    <div class="filter-group"><div class="stat-card"><h3 style="font-size:2.5rem;color:var(--primary)" id="totalScripts">0</h3><p style="color:var(--text-light)">Скриптов</p></div></div>
                    <div class="filter-group"><div class="stat-card"><h3 style="font-size:2.5rem;color:var(--primary)" id="totalRouters">0</h3><p style="color:var(--text-light)">Роутеров</p></div></div>
                    <div class="filter-group"><div class="stat-card"><h3 style="font-size:2.5rem;color:var(--primary)" id="totalSetups">0</h3><p style="color:var(--text-light)">Настроек</p></div></div>
                    <div class="filter-group"><div class="stat-card"><h3 style="font-size:2.5rem;color:var(--primary)" id="totalBrands">0</h3><p style="color:var(--text-light)">Производителей</p></div></div>
                </div>
            </div>
        </section>
        <div class="empty-state" id="emptyState" style="display:none">
            <div class="empty-icon"><i class="fas fa-inbox"></i></div>
            <h3>Данные не найдены</h3>
            <p>Попробуйте изменить параметры поиска или добавьте новый элемент</p>
        </div>
    </main>
    <div class="modal" id="scriptModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Добавить скрипт</h3>
                <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="scriptForm">
                    <input type="hidden" id="itemId">
                    <input type="hidden" id="itemType" value="script">
                    <div class="form-group">
                        <label class="form-label">Тип элемента</label>
                        <select class="form-select" id="itemTypeSelect" onchange="changeItemType()">
                            <option value="script">Скрипт</option>
                            <option value="router">Роутер</option>
                            <option value="setup">Настройка роутера</option>
                        </select>
                    </div>
                    <div id="scriptFields">
                        <div class="form-group">
                            <label class="form-label">Модель роутера</label>
                            <select class="form-select" id="scriptModel">
                                <option value="Общий скрипт">Общий скрипт</option>
                                <option value="Tenda TX 2 PRO">Tenda TX 2 PRO</option>
                                <option value="Tenda AC8">Tenda AC8</option>
                                <option value="Tenda AC5">Tenda AC5</option>
                                <option value="TP Link WR850N">TP Link WR850N</option>
                                <option value="Другая модель">Другая модель</option>
                            </select>
                        </div>
                        <div class="form-group" id="customModelGroup" style="display:none">
                            <label class="form-label">Название модели</label>
                            <input type="text" class="form-input" id="customModel" placeholder="Введите модель роутера">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Тип подключения</label>
                            <select class="form-select" id="connectionType">
                                <option value="Динамический">Динамический (DHCP)</option>
                                <option value="PPPoE">PPPoE</option>
                                <option value="Статический">Статический IP</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Категория</label>
                            <select class="form-select" id="scriptCategory">
                                <option value="Диагностика">Диагностика</option>
                                <option value="Настройка">Настройка</option>
                                <option value="Проблемы">Проблемы сети</option>
                                <option value="Баланс">Баланс и платежи</option>
                                <option value="Техработы">Технические работы</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Заголовок скрипта</label>
                            <input type="text" class="form-input" id="scriptTitle" placeholder="Краткое описание скрипта" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Текст скрипта</label>
                            <textarea class="form-textarea" id="scriptContent" placeholder="Введите текст скрипта..." required></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ключевые слова (через запятую)</label>
                            <input type="text" class="form-input" id="scriptTags" placeholder="скорость, интернет, wi-fi, баланс...">
                        </div>
                    </div>
                    <div id="routerFields" style="display:none">
                        <div class="form-group">
                            <label class="form-label">Модель роутера</label>
                            <input type="text" class="form-input" id="routerModel" placeholder="Например: Tenda TX 2 PRO" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Производитель</label>
                            <select class="form-select" id="routerBrand">
                                <option value="Tenda">Tenda</option>
                                <option value="TP-Link">TP-Link</option>
                                <option value="D-Link">D-Link</option>
                                <option value="Asus">Asus</option>
                                <option value="Huawei">Huawei</option>
                                <option value="Xiaomi">Xiaomi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Цена (руб.)</label>
                            <input type="number" class="form-input" id="routerPrice" placeholder="Например: 4800" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Диапазон Wi-Fi</label>
                            <select class="form-select" id="routerBand">
                                <option value="2.4 ГГц">2.4 ГГц</option>
                                <option value="5 ГГц">5 ГГц</option>
                                <option value="Двухдиапазонный">Двухдиапазонный</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Скорость Wi-Fi (Мбит/с)</label>
                            <input type="text" class="form-input" id="routerSpeed" placeholder="Например: 1501">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Описание</label>
                            <textarea class="form-textarea" id="routerDescription" placeholder="Дополнительная информация о роутере..."></textarea>
                        </div>
                    </div>
                    <div id="setupFields" style="display:none">
                        <div class="form-group">
                            <label class="form-label">Производитель роутера</label>
                            <select class="form-select" id="setupBrand" required>
                                <option value="Tenda">Tenda</option>
                                <option value="TP-Link">TP-Link</option>
                                <option value="D-Link">D-Link</option>
                                <option value="Asus">Asus</option>
                                <option value="Huawei">Huawei</option>
                                <option value="Xiaomi">Xiaomi</option>
                                <option value="Keenetic">Keenetic</option>
                                <option value="Mercusys">Mercusys</option>
                                <option value="Qtech">Qtech</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Тип подключения</label>
                            <select class="form-select" id="setupConnectionType" required>
                                <option value="Динамический">Динамический IP</option>
                                <option value="PPPoE">PPPoE</option>
                                <option value="Статический">Статический IP</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Заголовок инструкции</label>
                            <input type="text" class="form-input" id="setupTitle" placeholder="Например: Настройка Tenda на динамический IP" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Пошаговая инструкция</label>
                            <textarea class="form-textarea" id="setupSteps" placeholder="Введите пошаговую инструкцию. Каждый шаг с новой строки..." rows="8" required></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">Отмена</button>
                <button class="btn btn-primary" onclick="saveItem()">Сохранить</button>
            </div>
        </div>
    </div>
    <div class="notification" id="notification"><i class="fas fa-check-circle"></i> <span id="notificationText">Успешно!</span></div>
    <script>
        let scriptsDB = [
            {id:1,model:"Общий скрипт",type:"Динамический",category:"Диагностика",title:"Нет MAC-адреса роутера",content:"Добрый день! Не видим сеть вашего роутера, перезагрузите устройство: выключить роутер из розетки на 2-3 минуты и в момент выключения вытащить и вставить кабель интернета и поставить в тот же разъем до щелчка. Так же проверьте, чтобы провод плотно стоял в терминале. Далее включите и минут через 5-10 проверьте.",tags:["мак-адрес","перезагрузка","диагностика"]},
            {id:2,model:"Общий скрипт",type:"Динамический",category:"Информация",title:"Отказ в подключении - нет техвозможности",content:"Когда перезваниваем: вы только что звонили по проведению интернета в п.Св.Путь, к сожалению, там нет такой тех.возможности.",tags:["подключение","техвозможность","отказ"]},
            {id:3,model:"Tenda AC8",type:"Динамический",category:"Диагностика",title:"Удаленная диагностика и перезагрузка",content:"Провели удаленную диагностику по Вашему адресу, с нашей стороны проблем обнаружено не было. Попробуйте отключить роутер из розетки на 3-5 мин и, в момент отключения, вытащить и вставить до щелчка оптический кабель из роутера. Затем вытащить и вставить аккуратно из основного оборудования (белой коробочки с лампочками). Далее включить роутер и проверить подключение через 5 минут.",tags:["диагностика","оптика","перезагрузка"]},
            {id:4,model:"Общий скрипт",type:"Динамический",category:"Диагностика",title:"Статус интернета активен",content:"Статус интернета у Вас активен. Проблем на линии не наблюдается. Если интернет так же не восстановился, пожалуйста попробуйте сделать перезагрузку всего вашего оборудования из розетки. Если ситуация не изменится, то обратитесь повторно",tags:["статус","перезагрузка","оборудование"]},
            {id:5,model:"Общий скрипт",type:"Динамический",category:"Баланс",title:"Переключение тарифа на 100 мб/с",content:"Добрый день! Переключили тариф на 100 мб/с. Для корректной работы услуг Вам следует пополнить свой баланс, чтобы он составлял 800 рублей. Так же для беспрерывной работы интернета, необходимо чтобы к первому числу каждого месяца на балансе были средства равные абонентской плате Вашего тарифа.",tags:["тариф","баланс","оплата"]},
            {id:6,model:"Общий скрипт",type:"Динамический",category:"Диагностика",title:"Уточнение характера неполадки",content:"Здравствуйте.Подскажите, неполадка сохранилась на текущий момент?В чём характер неполадки?Скорость низкая или интернет прерывается?",tags:["неполадка","скорость","прерывание"]},
            {id:7,model:"Общий скрипт",type:"Динамический",category:"Настройка",title:"Настройка типа подключения",content:"Доброе утро, при перенастройке роутера все настройки можете оставить по умолчанию, кроме 'тип подключения', его нужно указать 'динамический' или DHCP.",tags:["настройка","тип подключения","DHCP"]},
            {id:8,model:"Общий скрипт",type:"Динамический",category:"Баланс",title:"Подтверждение оплаты",content:"Добрый день, да, всё верно, производится оплата, как обычно по № договора.",tags:["оплата","договор","подтверждение"]},
            {id:9,model:"Общий скрипт",type:"Динамический",category:"Информация",title:"Срок проверки техвозможности",content:"Проверка технической возможности подключения осуществляется в течение 5 рабочих дней, далее с вами свяжутся и сообщат о возможности.",tags:["техвозможность","подключение","сроки"]},
            {id:10,model:"Общий скрипт",type:"Динамический",category:"Диагностика",title:"Проблема с подключением к приложениям",content:"На данный момент удаленно видим, что интернет поступает, роутер в сети есть, поэтому проблема общая. Перезагрузили роутер? От питания отключали? Он должен подключаться, но с запретом к некоторым приложениям и сайтам. Ютуб должен работать.",tags:["приложения","блокировка","роутер"]}
        ];
        let routersDB = [
            {id:1,model:"Tenda TX 2 PRO",brand:"Tenda",price:4800,band:"Двухдиапазонный",speed:"1501 Мбит/с",description:"Wi-Fi 6 роутер с высокой скоростью и стабильным соединением."},
            {id:2,model:"Tenda AC8",brand:"Tenda",price:3600,band:"Двухдиапазонный",speed:"1000 Мбит/с",description:"Двухдиапазонный роутер с хорошим покрытием и гигабитными портами."},
            {id:3,model:"Tenda AC5",brand:"Tenda",price:3000,band:"2.4 ГГц",speed:"300 Мбит/с",description:"Бюджетный роутер для базовых потребностей."}
        ];
        let setupsDB = [
            {
                id:1,
                brand:"Tenda",
                type:"Динамический",
                title:"Настройка роутера Tenda на динамический IP",
                steps:[
                    "Шаг 1: Подключение роутера к источнику питания",
                    "Шаг 2: Доступ к веб-интерфейсу через 192.168.0.1 или 192.168.1.1",
                    "Шаг 3: В разделе 'Сеть' выбрать тип подключения 'Динамический IP'",
                    "Шаг 4: Установить MTU 1500, оставить MAC-адрес по умолчанию",
                    "Шаг 5: Проверить получение IP-адреса в разделе 'Состояние'",
                    "Шаг 6: Настроить Wi-Fi имя и пароль в разделе 'Беспроводные сети'",
                    "Шаг 7: Перезагрузить роутер для применения настроек",
                    "Шаг 8: Подключиться к Wi-Fi и проверить интернет"
                ]
            },
            {
                id:2,
                brand:"TP-Link",
                type:"Динамический",
                title:"Настройка роутера TP-Link на динамический IP",
                steps:[
                    "Шаг 1: Подключите кабель провайдера в WAN порт",
                    "Шаг 2: Откройте браузер и перейдите на 192.168.0.1 или 192.168.1.1",
                    "Шаг 3: Войдите с логином admin и паролем admin",
                    "Шаг 4: В разделе Network/WAN выберите Dynamic IP",
                    "Шаг 5: Включите DHCP-сервер для раздачи адресов",
                    "Шаг 6: Сохраните настройки и дождитесь перезагрузки",
                    "Шаг 7: Проверьте подключение в браузере",
                    "Шаг 8: Настройте Wi-Fi в разделе Wireless",
                    "Шаг 9: Сохраните все изменения и выйдите из интерфейса"
                ]
            },
            {
                id:3,
                brand:"Asus",
                type:"Динамический",
                title:"Настройка роутера Asus на динамический IP",
                steps:[
                    "Шаг 1: Подключите роутер к питанию и интернет-кабелю",
                    "Шаг 2: Доступ к веб-интерфейсу через 192.168.1.1 или 192.168.0.1",
                    "Шаг 3: В разделе 'Интернет' выбрать WAN тип Dynamic IP",
                    "Шаг 4: Установить MTU 1492 или 1500",
                    "Шаг 5: Проверить статус подключения в разделе 'Состояние'",
                    "Шаг 6: Настроить Wi-Fi с безопасностью WPA2-Personal",
                    "Шаг 7: Перезагрузить роутер через интерфейс или кнопку",
                    "Шаг 8: Проверить работу сети на устройствах"
                ]
            },
            {
                id:4,
                brand:"D-Link",
                type:"Динамический",
                title:"Настройка роутера D-Link на динамический IP",
                steps:[
                    "Шаг 1: Подключение роутера к питанию и кабелю провайдера",
                    "Шаг 2: Откройте браузер и введите 192.168.0.1 или 192.168.1.1",
                    "Шаг 3: Войдите с логином admin, пароль admin или пустой",
                    "Шаг 4: В разделе Setup/Internet Setup выберите Dynamic IP",
                    "Шаг 5: Оставьте MTU 1500, DNS автоматически",
                    "Шаг 6: Проверьте состояние соединения в Status",
                    "Шаг 7: Настройте Wi-Fi с WPA2-Personal и паролем",
                    "Шаг 8: Перезагрузите роутер через интерфейс",
                    "Шаг 9: Подключитесь к Wi-Fi и проверьте интернет"
                ]
            },
            {
                id:5,
                brand:"Huawei",
                type:"Динамический",
                title:"Настройка роутера Huawei на динамический IP",
                steps:[
                    "Шаг 1: Подключите роутер к питанию и WAN порту",
                    "Шаг 2: Доступ к интерфейсу через 192.168.1.1 или 192.168.0.1",
                    "Шаг 3: Логин admin, пароль admin или 1234",
                    "Шаг 4: В разделе 'Сеть' выберите WAN и Dynamic IP",
                    "Шаг 5: Установить MTU 1500, активировать авто-получение IP",
                    "Шаг 6: Проверить состояние соединения",
                    "Шаг 7: Настроить Wi-Fi с именем и паролем WPA2",
                    "Шаг 8: Перезагрузить роутер для применения настроек",
                    "Шаг 9: Проверить работу интернета на устройствах"
                ]
            },
            {
                id:6,
                brand:"Keenetic",
                type:"Динамический",
                title:"Настройка роутера Keenetic на динамический IP",
                steps:[
                    "Шаг 1: Подключите роутер к питанию и интернет-кабелю",
                    "Шаг 2: Откройте браузер и перейдите на 192.168.1.1 или 192.168.0.1",
                    "Шаг 3: Войдите с логином admin, паролем admin",
                    "Шаг 4: В разделе 'Интернет' нажмите 'Настроить подключение'",
                    "Шаг 5: Выберите 'Динамический IP', установите MTU 1500",
                    "Шаг 6: Проверьте получение IP-адреса в разделе 'Состояние'",
                    "Шаг 7: Настройте Wi-Fi с шифрованием WPA2",
                    "Шаг 8: Перезагрузите роутер через меню или отключением питания",
                    "Шаг 9: Подключитесь к Wi-Fi и проверьте доступ в интернет"
                ]
            },
            {
                id:7,
                brand:"Mercusys",
                type:"Динамический",
                title:"Настройка роутера Mercusys на динамический IP",
                steps:[
                    "Шаг 1: Подключите роутер к питанию и WAN порту",
                    "Шаг 2: Доступ к интерфейсу через 192.168.1.1 или 192.168.0.1",
                    "Шаг 3: Логин admin, пароль admin или пустой",
                    "Шаг 4: В разделе 'Интернет' выберите WAN и Dynamic IP",
                    "Шаг 5: Установите MTU 1492 или 1500, активируйте авто-получение IP",
                    "Шаг 6: Проверьте состояние подключения в разделе 'Статус'",
                    "Шаг 7: Настройте Wi-Fi с WPA2-Personal и надежным паролем",
                    "Шаг 8: Перезагрузите роутер через интерфейс или питание",
                    "Шаг 9: Проверьте доступ в интернет через Wi-Fi"
                ]
            },
            {
                id:8,
                brand:"Qtech",
                type:"Динамический",
                title:"Настройка роутера Qtech на динамический IP",
                steps:[
                    "Шаг 1: Подключите роутер к питанию и кабелю провайдера",
                    "Шаг 2: Откройте браузер и введите 192.168.1.1 или 192.168.0.1",
                    "Шаг 3: Войдите с логином admin, паролем admin или 1234",
                    "Шаг 4: В разделе 'Сетевые настройки' выберите Dynamic IP",
                    "Шаг 5: Установите MTU 1500, включите авто-получение IP",
                    "Шаг 6: Проверьте статус подключения в разделе 'Статус'",
                    "Шаг 7: Настройте Wi-Fi с безопасностью WPA2-Personal",
                    "Шаг 8: Перезагрузите роутер для применения настроек",
                    "Шаг 9: Подключитесь к Wi-Fi и проверьте работу интернета"
                ]
            },
            {
                id:9,
                brand:"Xiaomi",
                type:"Динамический",
                title:"Настройка роутера Xiaomi на динамический IP",
                steps:[
                    "Шаг 1: Подключите роутер к питанию и WAN порту",
                    "Шаг 2: Откройте браузер и перейдите на 192.168.31.1",
                    "Шаг 3: Логин admin, пароль admin или пустой",
                    "Шаг 4: В разделе 'Сеть' выберите WAN и 'Динамический IP'",
                    "Шаг 5: Установите MTU 1500, включите авто-получение IP",
                    "Шаг 6: Проверьте состояние соединения в 'Информации о подключении'",
                    "Шаг 7: Настройте Wi-Fi с WPA2-Personal и паролем",
                    "Шаг 8: Перезагрузите роутер через меню или отключением питания",
                    "Шаг 9: Подключитесь к Wi-Fi и проверьте доступ к сайтам"
                ]
            }
        ];
        document.addEventListener('DOMContentLoaded',function(){
            const savedScripts=localStorage.getItem('soykaScriptsDB'); if(savedScripts) scriptsDB=JSON.parse(savedScripts);
            const savedRouters=localStorage.getItem('soykaRoutersDB'); if(savedRouters) routersDB=JSON.parse(savedRouters);
            const savedSetups=localStorage.getItem('soykaSetupsDB'); if(savedSetups) setupsDB=JSON.parse(savedSetups);
            renderScripts(); renderRouters(); renderSetups(); updateStats(); setupEventListeners();
            document.querySelectorAll('.nav-btn').forEach(btn=>{btn.addEventListener('click',function(){switchSection(this.dataset.section);});});
        });
        function switchSection(sectionId){
            document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(btn=>{btn.classList.remove('active'); if(btn.dataset.section===sectionId) btn.classList.add('active');});
            if(sectionId==='stats') updateStats();
        }
        function renderScripts(filtered=null){renderItems('scriptsContainer',filtered||scriptsDB,'script');}
        function renderRouters(filtered=null){renderItems('routersContainer',filtered||routersDB,'router');}
        function renderSetups(filtered=null){renderItems('setupsContainer',filtered||setupsDB,'setup');}
        function renderItems(containerId,items,type){
            const c=document.getElementById(containerId);
            if(items.length===0){c.innerHTML=''; document.getElementById('emptyState').style.display='block'; return;}
            document.getElementById('emptyState').style.display='none';
            c.innerHTML=items.map(item=>{
                if(type==='script') return `
                    <div class="script-card card" data-id="${item.id}">
                        <div class="card-header script-header">
                            <div class="card-model">${item.model}</div>
                            <div class="card-badge">${item.type}</div>
                        </div>
                        <div class="card-content script-content">
                            <h4 style="margin-bottom:1rem;color:var(--primary);font-weight:600">${item.title}</h4>
                            <div class="script-text">${item.content.substring(0,180)}${item.content.length>180?'...':''}</div>
                            <div style="font-size:0.85rem;color:var(--gray);margin-top:0.5rem;padding:0.5rem 0;border-top:1px dashed var(--border)">
                                <i class="fas fa-tag" style="margin-right:0.3rem"></i> ${item.category}
                            </div>
                            ${item.tags&&item.tags.length>0?`<div class="script-tags">${item.tags.map(t=>`<span class="tag">${t}</span>`).join('')}</div>`:''}
                        </div>
                        <div class="card-actions">
                            <button class="icon-btn copy" onclick="copyScript(${item.id})" title="Копировать"><i class="far fa-copy"></i></button>
                            <button class="icon-btn edit" onclick="editItem('script',${item.id})" title="Редактировать"><i class="far fa-edit"></i></button>
                            <button class="icon-btn delete" onclick="deleteItem('script',${item.id})" title="Удалить"><i class="far fa-trash-alt"></i></button>
                        </div>
                    </div>`;
                if(type==='router') return `
                    <div class="router-card card" data-id="${item.id}">
                        <div class="card-header router-header">
                            <div class="card-model">${item.model}</div>
                            <div class="router-price">${item.price} руб.</div>
                        </div>
                        <div class="card-content router-content">
                            <ul class="router-specs">
                                <li><span class="spec-label">Производитель:</span><span class="spec-value">${item.brand}</span></li>
                                <li><span class="spec-label">Диапазон Wi-Fi:</span><span class="spec-value">${item.band}</span></li>
                                <li><span class="spec-label">Скорость Wi-Fi:</span><span class="spec-value">${item.speed}</span></li>
                            </ul>
                            <div style="font-size:0.9rem;color:var(--text-light);margin-top:1rem">${item.description}</div>
                        </div>
                        <div class="card-actions">
                            <button class="icon-btn edit" onclick="editItem('router',${item.id})" title="Редактировать"><i class="far fa-edit"></i></button>
                            <button class="icon-btn delete" onclick="deleteItem('router',${item.id})" title="Удалить"><i class="far fa-trash-alt"></i></button>
                        </div>
                    </div>`;
                if(type==='setup') return `
                    <div class="setup-card card" data-id="${item.id}">
                        <div class="card-header setup-header">
                            <div class="card-brand">${item.brand}</div>
                            <div class="setup-badge">${item.type}</div>
                        </div>
                        <div class="card-content setup-content">
                            <h4 style="margin-bottom:1rem;color:var(--primary);font-weight:600">${item.title}</h4>
                            <ul class="setup-steps">
                                ${item.steps.map((s,i)=>`<li><div class="step-number">${i+1}</div><div class="step-text"><div class="step-title">${s.split(':')[0]}:</div><div>${s.split(':')[1]||s}</div></div></li>`).join('')}
                            </ul>
                        </div>
                        <div class="card-actions">
                            <button class="icon-btn copy" onclick="copySetup(${item.id})" title="Копировать"><i class="far fa-copy"></i></button>
                            <button class="icon-btn edit" onclick="editItem('setup',${item.id})" title="Редактировать"><i class="far fa-edit"></i></button>
                            <button class="icon-btn delete" onclick="deleteItem('setup',${item.id})" title="Удалить"><i class="far fa-trash-alt"></i></button>
                        </div>
                    </div>`;
            }).join('');
        }
        function setupEventListeners(){
            document.getElementById('searchScripts').addEventListener('input',filterScripts);
            document.getElementById('filterScriptModel').addEventListener('change',filterScripts);
            document.getElementById('filterScriptCategory').addEventListener('change',filterScripts);
            document.getElementById('filterScriptType').addEventListener('change',filterScripts);
            document.getElementById('searchRouters').addEventListener('input',filterRouters);
            document.getElementById('filterRouterBrand').addEventListener('change',filterRouters);
            document.getElementById('filterRouterBand').addEventListener('change',filterRouters);
            document.getElementById('filterRouterPrice').addEventListener('change',filterRouters);
            document.getElementById('searchSetups').addEventListener('input',filterSetups);
            document.getElementById('filterSetupBrand').addEventListener('change',filterSetups);
            document.getElementById('filterSetupType').addEventListener('change',filterSetups);
            document.getElementById('scriptModel').addEventListener('change',function(){
                document.getElementById('customModelGroup').style.display=this.value==='Другая модель'?'block':'none';
            });
        }
        function filterScripts(){
            const s=document.getElementById('searchScripts').value.toLowerCase();
            const m=document.getElementById('filterScriptModel').value;
            const c=document.getElementById('filterScriptCategory').value;
            const t=document.getElementById('filterScriptType').value;
            const filtered=scriptsDB.filter(sc=>{
                const match=!s||sc.title.toLowerCase().includes(s)||sc.content.toLowerCase().includes(s)||(sc.tags&&sc.tags.some(tg=>tg.toLowerCase().includes(s)))||sc.model.toLowerCase().includes(s);
                return match&&(!m||sc.model===m)&&(!c||sc.category===c)&&(!t||sc.type===t);
            });
            renderScripts(filtered);
        }
        function filterRouters(){
            const s=document.getElementById('searchRouters').value.toLowerCase();
            const b=document.getElementById('filterRouterBrand').value;
            const ba=document.getElementById('filterRouterBand').value;
            const p=document.getElementById('filterRouterPrice').value;
            const filtered=routersDB.filter(r=>{
                const match=!s||r.model.toLowerCase().includes(s)||r.brand.toLowerCase().includes(s)||r.description.toLowerCase().includes(s);
                return match&&(!b||r.brand===b)&&(!ba||r.band===ba)&&(!p||(p==='до 3000'&&r.price<=3000||p==='3000-5000'&&r.price>=3000&&r.price<=5000||p==='от 5000'&&r.price>=5000));
            });
            renderRouters(filtered);
        }
        function filterSetups(){
            const s=document.getElementById('searchSetups').value.toLowerCase();
            const b=document.getElementById('filterSetupBrand').value;
            const t=document.getElementById('filterSetupType').value;
            const filtered=setupsDB.filter(st=>{
                const match=!s||st.title.toLowerCase().includes(s)||st.brand.toLowerCase().includes(s);
                return match&&(!b||st.brand===b)&&(!t||st.type===t);
            });
            renderSetups(filtered);
        }
        function clearFilters(){
            document.getElementById('searchScripts').value='';
            document.getElementById('filterScriptModel').selectedIndex=0;
            document.getElementById('filterScriptCategory').selectedIndex=0;
            document.getElementById('filterScriptType').selectedIndex=0;
            renderScripts();
        }
        let editingId=null,currentItemType='script';
        function openModal(itemType='script',item=null){
            editingId=item?item.id:null;
            currentItemType=itemType;
            document.getElementById('itemTypeSelect').value=itemType;
            changeItemType();
            document.getElementById('modalTitle').textContent=item?`Редактировать ${getItemTypeName(itemType)}`:`Добавить ${getItemTypeName(itemType)}`;
            if(item){
                document.getElementById('itemId').value=item.id;
                document.getElementById('itemType').value=itemType;
                if(itemType==='script'){
                    document.getElementById('scriptModel').value=item.model==='Другая модель'?'Другая модель':item.model;
                    document.getElementById('customModel').value=item.model==='Другая модель'?'':item.model;
                    document.getElementById('customModelGroup').style.display=item.model==='Другая модель'?'block':'none';
                    document.getElementById('connectionType').value=item.type;
                    document.getElementById('scriptCategory').value=item.category;
                    document.getElementById('scriptTitle').value=item.title;
                    document.getElementById('scriptContent').value=item.content;
                    document.getElementById('scriptTags').value=item.tags?item.tags.join(', '):'';
                }else if(itemType==='router'){
                    document.getElementById('routerModel').value=item.model;
                    document.getElementById('routerBrand').value=item.brand;
                    document.getElementById('routerPrice').value=item.price;
                    document.getElementById('routerBand').value=item.band;
                    document.getElementById('routerSpeed').value=item.speed;
                    document.getElementById('routerDescription').value=item.description;
                }else if(itemType==='setup'){
                    document.getElementById('setupBrand').value=item.brand;
                    document.getElementById('setupConnectionType').value=item.type;
                    document.getElementById('setupTitle').value=item.title;
                    document.getElementById('setupSteps').value=Array.isArray(item.steps)?item.steps.join('\n'):'';
                }
            }else{document.getElementById('scriptForm').reset(); document.getElementById('customModelGroup').style.display='none'; document.getElementById('itemId').value='';}
            document.getElementById('scriptModal').style.display='flex';
        }
        function getItemTypeName(t){return t==='script'?'скрипт':t==='router'?'роутер':'настройку';}
        function changeItemType(){
            const t=document.getElementById('itemTypeSelect').value;
            currentItemType=t;
            document.getElementById('scriptFields').style.display='none';
            document.getElementById('routerFields').style.display='none';
            document.getElementById('setupFields').style.display='none';
            if(t==='script'){document.getElementById('scriptFields').style.display='block'; document.getElementById('modalTitle').textContent=editingId?'Редактировать скрипт':'Добавить скрипт';}
            else if(t==='router'){document.getElementById('routerFields').style.display='block'; document.getElementById('modalTitle').textContent=editingId?'Редактировать роутер':'Добавить роутер';}
            else if(t==='setup'){document.getElementById('setupFields').style.display='block'; document.getElementById('modalTitle').textContent=editingId?'Редактировать настройку':'Добавить настройку';}
        }
        function closeModal(){document.getElementById('scriptModal').style.display='none'; editingId=null;}
        function saveItem(){
            if(currentItemType==='script') saveScript();
            else if(currentItemType==='router') saveRouter();
            else if(currentItemType==='setup') saveSetup();
        }
        function saveScript(){
            const m=document.getElementById('scriptModel').value;
            const model=m==='Другая модель'?document.getElementById('customModel').value:m;
            if(!model||!document.getElementById('scriptTitle').value||!document.getElementById('scriptContent').value){showNotification('Заполните обязательные поля!','error'); return;}
            const s={
                id:editingId||Date.now(),
                model:model||'Общий скрипт',
                type:document.getElementById('connectionType').value,
                category:document.getElementById('scriptCategory').value,
                title:document.getElementById('scriptTitle').value,
                content:document.getElementById('scriptContent').value,
                tags:document.getElementById('scriptTags').value.split(',').map(t=>t.trim()).filter(t=>t)
            };
            if(editingId){const i=scriptsDB.findIndex(sc=>sc.id===editingId); scriptsDB[i]=s; showNotification('Скрипт обновлен!');}
            else{scriptsDB.unshift(s); showNotification('Скрипт добавлен!');}
            localStorage.setItem('soykaScriptsDB',JSON.stringify(scriptsDB));
            renderScripts(); closeModal(); filterScripts(); updateStats();
        }
        function saveRouter(){
            if(!document.getElementById('routerModel').value||!document.getElementById('routerPrice').value){showNotification('Заполните обязательные поля!','error'); return;}
            const r={
                id:editingId||Date.now(),
                model:document.getElementById('routerModel').value,
                brand:document.getElementById('routerBrand').value,
                price:parseInt(document.getElementById('routerPrice').value),
                band:document.getElementById('routerBand').value,
                speed:document.getElementById('routerSpeed').value,
                description:document.getElementById('routerDescription').value
            };
            if(editingId){const i=routersDB.findIndex(ro=>ro.id===editingId); routersDB[i]=r; showNotification('Роутер обновлен!');}
            else{routersDB.unshift(r); showNotification('Роутер добавлен!');}
            localStorage.setItem('soykaRoutersDB',JSON.stringify(routersDB));
            renderRouters(); closeModal(); filterRouters(); updateStats();
        }
        function saveSetup(){
            if(!document.getElementById('setupBrand').value||!document.getElementById('setupTitle').value||!document.getElementById('setupSteps').value){showNotification('Заполните обязательные поля!','error'); return;}
            const steps=document.getElementById('setupSteps').value.split('\n').map(s=>s.trim()).filter(s=>s.length>0);
            if(steps.length===0){showNotification('Добавьте хотя бы один шаг!','error'); return;}
            const su={
                id:editingId||Date.now(),
                brand:document.getElementById('setupBrand').value,
                type:document.getElementById('setupConnectionType').value,
                title:document.getElementById('setupTitle').value,
                steps:steps
            };
            if(editingId){const i=setupsDB.findIndex(st=>st.id===editingId); setupsDB[i]=su; showNotification('Настройка обновлена!');}
            else{setupsDB.unshift(su); showNotification('Настройка добавлена!');}
            localStorage.setItem('soykaSetupsDB',JSON.stringify(setupsDB));
            renderSetups(); closeModal(); filterSetups(); updateStats();
        }
        function editItem(type,id){
            let item;
            if(type==='script') item=scriptsDB.find(s=>s.id===id);
            else if(type==='router') item=routersDB.find(r=>r.id===id);
            else if(type==='setup') item=setupsDB.find(s=>s.id===id);
            if(item) openModal(type,item);
        }
        function deleteItem(type,id){
            if(!confirm('Вы уверены, что хотите удалить?')) return;
            if(type==='script'){scriptsDB=scriptsDB.filter(s=>s.id!==id); localStorage.setItem('soykaScriptsDB',JSON.stringify(scriptsDB)); renderScripts(); filterScripts();}
            else if(type==='router'){routersDB=routersDB.filter(r=>r.id!==id); localStorage.setItem('soykaRoutersDB',JSON.stringify(routersDB)); renderRouters(); filterRouters();}
            else if(type==='setup'){setupsDB=setupsDB.filter(st=>st.id!==id); localStorage.setItem('soykaSetupsDB',JSON.stringify(setupsDB)); renderSetups(); filterSetups();}
            updateStats(); showNotification('Удалено!');
        }
        function copyScript(id){
            const s=scriptsDB.find(sc=>sc.id===id);
            if(s) navigator.clipboard.writeText(`${s.model} | ${s.type}\n\n${s.title}\n\n${s.content}`).then(()=>showNotification('Скрипт скопирован!')).catch(err=>showNotification('Ошибка копирования','error'));
        }
        function copySetup(id){
            const s=setupsDB.find(st=>st.id===id);
            if(s) navigator.clipboard.writeText(`${s.brand} - ${s.title}\nТип: ${s.type}\n\nИнструкция:\n${s.steps.map((st,i)=>`${i+1}. ${st}`).join('\n')}`).then(()=>showNotification('Инструкция скопирована!')).catch(err=>showNotification('Ошибка копирования','error'));
        }
        function exportScripts(){
            const data=`data:application/json;charset=utf-8,${encodeURIComponent(JSON.stringify(scriptsDB,null,2))}`;
            const a=document.createElement('a'); a.setAttribute('href',data); a.setAttribute('download',`soyka_scripts_${new Date().toISOString().slice(0,10)}.json`); a.click();
            showNotification('Скрипты экспортированы!');
        }
        function exportRouters(){
            const data=`data:application/json;charset=utf-8,${encodeURIComponent(JSON.stringify(routersDB,null,2))}`;
            const a=document.createElement('a'); a.setAttribute('href',data); a.setAttribute('download',`soyka_routers_${new Date().toISOString().slice(0,10)}.json`); a.click();
            showNotification('Роутеры экспортированы!');
        }
        function updateStats(){
            document.getElementById('totalScripts').textContent=scriptsDB.length;
            document.getElementById('totalRouters').textContent=routersDB.length;
            document.getElementById('totalSetups').textContent=setupsDB.length;
            const brands=[...new Set(routersDB.map(r=>r.brand).concat(setupsDB.map(s=>s.brand)))];
            document.getElementById('totalBrands').textContent=brands.length;
        }
        function showNotification(msg,type='success'){
            const n=document.getElementById('notification');
            n.style.background=type==='error'?'var(--danger)':'var(--success)';
            document.getElementById('notificationText').textContent=msg;
            n.style.display='flex'; setTimeout(()=>{n.style.display='none';},3000);
        }
        window.onclick=function(e){if(e.target===document.getElementById('scriptModal')) closeModal();};
    </script>
</body>
</html>
