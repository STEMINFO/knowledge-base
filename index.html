<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сойка | База знаний 2025</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563eb; --primary-dark: #1d4ed8; --primary-light: #dbeafe;
            --secondary: #f8fafc; --accent: #f97316; --accent2: #10b981;
            --text: #1e293b; --text-light: #64748b;
            --border: #e2e8f0; --success: #10b981; --warning: #f59e0b; --danger: #ef4444;
            --card-bg: #ffffff; --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 12px; --radius-sm: 8px;
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * { 
            margin:0; padding:0; box-sizing:border-box; 
            -webkit-tap-highlight-color: transparent;
        }
        body { 
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color:var(--text); 
            line-height:1.6;
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            padding-bottom: 2rem;
        }
        
        /* Хедер */
        .header {
            background: white;
            color: var(--text);
            padding: 1rem 2rem;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid var(--primary);
        }
        .header-container { 
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }
        .logo-text h1 {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--primary);
        }
        .logo-text p {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 0.2rem;
        }
        
        /* Навигация */
        .nav {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        .nav-btn {
            background: transparent;
            color: var(--text-light);
            border: 2px solid transparent;
            padding: 0.7rem 1.2rem;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            min-height: 44px;
        }
        .nav-btn:hover {
            background: var(--primary-light);
            color: var(--primary);
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }
        .nav-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .nav-btn i {
            font-size: 1.1rem;
        }
        
        /* Основной контейнер */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }
        
        /* Быстрые действия */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .quick-action-btn {
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            text-decoration: none;
            color: var(--text);
            transition: var(--transition);
            cursor: pointer;
            min-height: 140px;
        }
        .quick-action-btn:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        .quick-action-btn i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        .quick-action-btn h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .quick-action-btn p {
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        /* Панель управления */
        .control-panel {
            background: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        /* Поиск */
        .search-container {
            position: relative;
            margin-bottom: 1.5rem;
        }
        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }
        .search-input {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 3rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
            font-family: 'Inter', sans-serif;
            min-height: 48px;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        /* Фильтры */
        .filters-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .filter-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary);
        }
        .filter-select {
            padding: 0.8rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            background: white;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            min-height: 44px;
        }
        .filter-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        /* Кнопки действий */
        .actions-row {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }
        .btn {
            padding: 0.8rem 1.5rem;
            border: 2px solid transparent;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: 'Inter', sans-serif;
            min-height: 44px;
            min-width: 44px;
        }
        .btn:active {
            transform: scale(0.98);
        }
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
        }
        .btn-success {
            background: var(--success);
            color: white;
        }
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        .btn-outline {
            background: transparent;
            border-color: var(--border);
            color: var(--primary);
        }
        .btn-outline:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }
        
        /* Карточки */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }
        
        .card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            padding: 1.2rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-light);
        }
        .script-header { background: #e0f2fe; }
        .router-header { background: #fef3c7; }
        .setup-header { background: #dcfce7; }
        
        .card-model, .card-brand {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }
        
        .card-badge, .router-price, .setup-badge {
            padding: 0.3rem 0.8rem;
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .card-badge, .setup-badge { background: var(--primary); }
        .router-price { background: var(--accent); }
        
        .card-content {
            padding: 1.5rem;
            flex-grow: 1;
            overflow-y: auto;
            max-height: 300px;
        }
        .card-content::-webkit-scrollbar {
            width: 6px;
        }
        .card-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        .card-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }
        
        .script-text {
            line-height: 1.6;
            margin-bottom: 1rem;
            color: var(--text);
            font-size: 0.95rem;
        }
        
        .script-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .tag {
            background: var(--primary-light);
            padding: 0.3rem 0.7rem;
            border-radius: 4px;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 500;
        }
        
        .router-specs, .setup-steps {
            list-style: none;
            margin: 1rem 0;
        }
        .router-specs li {
            padding: 0.5rem 0;
            border-bottom: 1px dashed var(--border);
            display: flex;
            justify-content: space-between;
        }
        .router-specs li:last-child { border-bottom: none; }
        .spec-label { color: var(--text-light); font-weight: 500; }
        .spec-value { font-weight: 600; color: var(--text); }
        
        .setup-steps li {
            padding: 0.8rem 0;
            border-bottom: 1px dashed var(--border);
            display: flex;
            align-items: flex-start;
            gap: 0.8rem;
        }
        .setup-steps li:last-child { border-bottom: none; }
        .step-number {
            background: var(--primary);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            flex-shrink: 0;
            margin-top: 0.1rem;
        }
        .step-text { flex: 1; font-size: 0.95rem; }
        .step-title { font-weight: 600; color: var(--primary); margin-bottom: 0.3rem; }
        
        .card-actions {
            padding: 1rem 1.2rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            background: #f8fafc;
        }
        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid transparent;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: var(--text-light);
            min-width: 36px;
            min-height: 36px;
        }
        .icon-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
            border-color: var(--primary);
        }
        .icon-btn.copy:hover { background: var(--success); border-color: var(--success); }
        .icon-btn.edit:hover { background: var(--warning); border-color: var(--warning); }
        .icon-btn.delete:hover { background: var(--danger); border-color: var(--danger); }
        
        /* Статистика */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        .stat-card {
            background: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            text-align: center;
            transition: var(--transition);
        }
        .stat-card:hover {
            transform: translateY(-3px);
        }
        .stat-card h3 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        .stat-card p {
            color: var(--text-light);
            font-size: 1rem;
            font-weight: 600;
        }
        
        /* Модальное окно */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .modal-content {
            background: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        @keyframes modalSlide {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-light);
        }
        .modal-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        .modal-close:hover {
            background: var(--primary-light);
            color: var(--primary);
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.2rem;
        }
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.95rem;
        }
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.95rem;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            min-height: 44px;
        }
        .form-textarea {
            min-height: 150px;
            resize: vertical;
            line-height: 1.5;
        }
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .modal-footer {
            padding: 1.2rem 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 0.8rem;
        }
        
        /* Уведомление */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background: var(--success);
            color: white;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow);
            display: none;
            z-index: 3000;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            min-height: 44px;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        /* Кнопка наверх */
        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
            transition: var(--transition);
            border: none;
            min-width: 50px;
            min-height: 50px;
        }
        .scroll-top:hover {
            background: var(--primary-dark);
            transform: translateY(-3px) scale(1.1);
        }
        
        /* Пустое состояние */
        .empty-state {
            text-align: center;
            padding: 3rem 1.5rem;
            color: var(--text-light);
            grid-column: 1/-1;
        }
        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--border);
            opacity: 0.5;
        }
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }
        
        .section { display: none; }
        .section.active { display: block; }
        
        /* Футер */
        .footer {
            background: white;
            border-top: 1px solid var(--border);
            padding: 1.5rem;
            margin-top: 3rem;
            text-align: center;
            color: var(--text-light);
        }
        .footer p {
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        .footer-links a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            font-size: 0.9rem;
        }
        .footer-links a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        /* Дополнительные улучшения */
        .highlight {
            background: #fff3cd;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .url-link {
            color: var(--primary);
            text-decoration: underline;
            word-break: break-all;
        }
        
        .copy-indicator {
            position: absolute;
            background: var(--success);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
            animation: fadeOut 2s forwards;
        }
        @keyframes fadeOut {
            0% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        /* Адаптивность */
        @media (max-width: 1024px) {
            .content-grid { grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); }
        }
        @media (max-width: 768px) {
            .header-container { flex-direction: column; gap: 1rem; }
            .nav { width: 100%; overflow-x: auto; padding-bottom: 0.5rem; }
            .content-grid { grid-template-columns: 1fr; }
            .filters-row { grid-template-columns: 1fr; }
            .quick-actions { grid-template-columns: 1fr; }
            .modal-content { max-height: 95vh; margin: 1rem; }
            .actions-row { justify-content: center; }
            .btn span:not(.fa) { display: none; }
            .btn { padding: 0.8rem 1rem; }
        }
        
        @media (max-width: 480px) {
            .container { padding: 0 1rem; }
            .header { padding: 1rem; }
            .nav-btn { padding: 0.6rem 1rem; font-size: 0.9rem; }
            .nav-btn span:not(.fa) { display: none; }
            .nav-btn i { margin: 0; }
            .card-content { padding: 1rem; }
        }
    </style>
</head>
<body>
    <!-- Кнопка наверх -->
    <button class="scroll-top" id="scrollTop" style="display: none;" aria-label="Наверх">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- Хедер -->
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon" aria-hidden="true"><i class="fas fa-database"></i></div>
                <div class="logo-text">
                    <h1>База знаний Сойка</h1>
                    <p>Скрипты поддержки • Настройка роутеров • Решения проблем</p>
                </div>
            </div>
            <nav class="nav" aria-label="Основная навигация">
                <button class="nav-btn home-btn active" onclick="switchSection('scripts')" aria-label="Главная">
                    <i class="fas fa-home"></i>
                    <span>Главная</span>
                </button>
                <button class="nav-btn" data-section="scripts" aria-label="Скрипты">
                    <i class="fas fa-comments"></i>
                    <span>Скрипты</span>
                </button>
                <button class="nav-btn" data-section="routers" aria-label="Роутеры">
                    <i class="fas fa-wifi"></i>
                    <span>Роутеры</span>
                </button>
                <button class="nav-btn" data-section="setups" aria-label="Настройки">
                    <i class="fas fa-cogs"></i>
                    <span>Настройки</span>
                </button>
                <button class="nav-btn" data-section="stats" aria-label="Статистика">
                    <i class="fas fa-chart-bar"></i>
                    <span>Статистика</span>
                </button>
                <button class="nav-btn" onclick="openModal()" style="background: var(--accent2); color: white;" aria-label="Добавить элемент">
                    <i class="fas fa-plus"></i>
                    <span>Добавить</span>
                </button>
            </nav>
        </div>
    </header>
    
    <main class="container">
        <!-- Быстрые действия -->
        <div class="quick-actions" id="quickActions">
            <button class="quick-action-btn" onclick="switchSection('scripts')">
                <i class="fas fa-comment-dots"></i>
                <h3>Быстрый ответ</h3>
                <p>Используйте готовые скрипты для клиентов</p>
            </button>
            <button class="quick-action-btn" onclick="switchSection('routers')">
                <i class="fas fa-search"></i>
                <h3>Поиск роутера</h3>
                <p>Найдите оборудование по параметрам</p>
            </button>
            <button class="quick-action-btn" onclick="openModal('setup')">
                <i class="fas fa-book"></i>
                <h3>Новая инструкция</h3>
                <p>Создайте инструкцию по настройке</p>
            </button>
            <button class="quick-action-btn" onclick="exportAllData()">
                <i class="fas fa-download"></i>
                <h3>Экспорт данных</h3>
                <p>Скачайте всю базу знаний</p>
            </button>
        </div>
        
        <!-- Раздел скриптов -->
        <section id="scripts" class="section active">
            <div class="control-panel">
                <h2 style="margin-bottom:1rem;color:var(--primary);">
                    <i class="fas fa-comments" style="margin-right:0.5rem;"></i>Скрипты поддержки
                </h2>
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchScripts" placeholder="Поиск по скриптам..." aria-label="Поиск по скриптам">
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label" for="filterScriptModel">Модель роутера</label>
                        <select class="filter-select" id="filterScriptModel">
                            <option value="">Все модели</option>
                            <option value="Tenda TX 2 PRO">Tenda TX 2 PRO</option>
                            <option value="Tenda AC8">Tenda AC8</option>
                            <option value="Tenda AC5">Tenda AC5</option>
                            <option value="TP Link WR850N">TP Link WR850N</option>
                            <option value="Общий скрипт">Общий скрипт</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filterScriptCategory">Категория</label>
                        <select class="filter-select" id="filterScriptCategory">
                            <option value="">Все категории</option>
                            <option value="Диагностика">Диагностика</option>
                            <option value="Настройка">Настройка</option>
                            <option value="Проблемы">Проблемы сети</option>
                            <option value="Баланс">Баланс и платежи</option>
                            <option value="Техработы">Технические работы</option>
                            <option value="Аварии">Аварии и обрывы</option>
                            <option value="Подключение">Подключение услуг</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filterScriptType">Тип проблемы</label>
                        <select class="filter-select" id="filterScriptType">
                            <option value="">Все типы</option>
                            <option value="Динамический">Нет интернета</option>
                            <option value="Скорость">Медленная скорость</option>
                            <option value="TV">Проблемы с ТВ</option>
                            <option value="Оборудование">Проблемы оборудования</option>
                        </select>
                    </div>
                </div>
                <div class="actions-row">
                    <button class="btn btn-primary" onclick="openModal('script')">
                        <i class="fas fa-plus-circle"></i> <span>Новый скрипт</span>
                    </button>
                    <button class="btn btn-success" onclick="exportScripts()">
                        <i class="fas fa-file-export"></i> <span>Экспорт</span>
                    </button>
                    <button class="btn btn-outline" onclick="clearFilters()">
                        <i class="fas fa-filter-circle-xmark"></i> <span>Сбросить</span>
                    </button>
                </div>
            </div>
            <div class="content-grid" id="scriptsContainer"></div>
        </section>

        <!-- Раздел роутеров -->
        <section id="routers" class="section">
            <div class="control-panel">
                <h2 style="margin-bottom:1rem;color:var(--primary);">
                    <i class="fas fa-wifi" style="margin-right:0.5rem;"></i>Каталог роутеров
                </h2>
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchRouters" placeholder="Поиск по роутерам..." aria-label="Поиск по роутерам">
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label" for="filterRouterBrand">Производитель</label>
                        <select class="filter-select" id="filterRouterBrand">
                            <option value="">Все производители</option>
                            <option value="Tenda">Tenda</option>
                            <option value="TP-Link">TP-Link</option>
                            <option value="D-Link">D-Link</option>
                            <option value="Asus">Asus</option>
                            <option value="Huawei">Huawei</option>
                            <option value="Xiaomi">Xiaomi</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filterRouterBand">Диапазон Wi-Fi</label>
                        <select class="filter-select" id="filterRouterBand">
                            <option value="">Все диапазоны</option>
                            <option value="2.4 ГГц">2.4 ГГц</option>
                            <option value="5 ГГц">5 ГГц</option>
                            <option value="Двухдиапазонный">Двухдиапазонный</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filterRouterPrice">Цена</label>
                        <select class="filter-select" id="filterRouterPrice">
                            <option value="">Любая цена</option>
                            <option value="до 3000">до 3000 руб</option>
                            <option value="3000-5000">3000-5000 руб</option>
                            <option value="от 5000">от 5000 руб</option>
                        </select>
                    </div>
                </div>
                <div class="actions-row">
                    <button class="btn btn-primary" onclick="openModal('router')">
                        <i class="fas fa-plus-circle"></i> <span>Новый роутер</span>
                    </button>
                    <button class="btn btn-success" onclick="exportRouters()">
                        <i class="fas fa-file-export"></i> <span>Экспорт</span>
                    </button>
                </div>
            </div>
            <div class="content-grid" id="routersContainer"></div>
        </section>

        <!-- Раздел настроек -->
        <section id="setups" class="section">
            <div class="control-panel">
                <h2 style="margin-bottom:1rem;color:var(--primary);">
                    <i class="fas fa-cogs" style="margin-right:0.5rem;"></i>Инструкции по настройке
                </h2>
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="searchSetups" placeholder="Поиск по настройкам..." aria-label="Поиск по настройкам">
                </div>
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label" for="filterSetupBrand">Производитель</label>
                        <select class="filter-select" id="filterSetupBrand">
                            <option value="">Все производители</option>
                            <option value="Tenda">Tenda</option>
                            <option value="TP-Link">TP-Link</option>
                            <option value="D-Link">D-Link</option>
                            <option value="Asus">Asus</option>
                            <option value="Huawei">Huawei</option>
                            <option value="Xiaomi">Xiaomi</option>
                            <option value="Keenetic">Keenetic</option>
                            <option value="Mercusys">Mercusys</option>
                            <option value="Qtech">Qtech</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label" for="filterSetupType">Тип подключения</label>
                        <select class="filter-select" id="filterSetupType">
                            <option value="">Все типы</option>
                            <option value="Динамический">Динамический IP</option>
                            <option value="PPPoE">PPPoE</option>
                            <option value="Статический">Статический IP</option>
                        </select>
                    </div>
                </div>
                <div class="actions-row">
                    <button class="btn btn-primary" onclick="openModal('setup')">
                        <i class="fas fa-plus-circle"></i> <span>Новая инструкция</span>
                    </button>
                </div>
            </div>
            <div class="content-grid" id="setupsContainer"></div>
        </section>

        <!-- Раздел статистики -->
        <section id="stats" class="section">
            <div class="control-panel">
                <h2 style="margin-bottom:1.5rem;color:var(--primary);">
                    <i class="fas fa-chart-bar" style="margin-right:0.5rem;"></i>Статистика базы знаний
                </h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="totalScripts">0</h3>
                        <p>Скриптов поддержки</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalRouters">0</h3>
                        <p>Моделей роутеров</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalSetups">0</h3>
                        <p>Инструкций</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="totalCopies">0</h3>
                        <p>Копирований сегодня</p>
                    </div>
                </div>
                
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--primary-light); border-radius: var(--radius);">
                    <h3 style="margin-bottom:1rem;color:var(--primary);">Последние обновления</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div>
                            <h4 style="color:var(--text-light);font-size:0.9rem;margin-bottom:0.5rem;">Последнее обновление</h4>
                            <p style="font-weight:600;" id="lastUpdate">Сегодня</p>
                        </div>
                        <div>
                            <h4 style="color:var(--text-light);font-size:0.9rem;margin-bottom:0.5rem;">Популярная категория</h4>
                            <p style="font-weight:600;" id="popularCategory">Диагностика</p>
                        </div>
                        <div>
                            <h4 style="color:var(--text-light);font-size:0.9rem;margin-bottom:0.5rem;">Всего копирований</h4>
                            <p style="font-weight:600;" id="totalCopiesAll">0</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="empty-state" id="emptyState" style="display:none">
            <div class="empty-icon"><i class="fas fa-inbox"></i></div>
            <h3>Ничего не найдено</h3>
            <p>Попробуйте изменить параметры поиска или добавьте новый элемент</p>
            <button class="btn btn-primary" style="margin-top:1.5rem;" onclick="openModal()">
                <i class="fas fa-plus"></i> Добавить элемент
            </button>
        </div>
    </main>

    <!-- Футер -->
    <footer class="footer">
        <p>© 2025 Сойка | База знаний поддержки клиентов</p>
        <p>Версия 2.1 | Обновлено: <span id="currentDate"></span></p>
        <div class="footer-links">
            <button class="footer-link" onclick="switchSection('scripts')">Скрипты</button>
            <button class="footer-link" onclick="switchSection('routers')">Роутеры</button>
            <button class="footer-link" onclick="switchSection('setups')">Настройки</button>
            <button class="footer-link" onclick="showHelp()">Помощь</button>
            <button class="footer-link" onclick="showKeyboardShortcuts()">Горячие клавиши</button>
        </div>
    </footer>

    <!-- Модальное окно -->
    <div class="modal" id="scriptModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Добавить скрипт</h3>
                <button class="modal-close" onclick="closeModal()" aria-label="Закрыть"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="scriptForm">
                    <input type="hidden" id="itemId">
                    <input type="hidden" id="itemType" value="script">
                    <div class="form-group">
                        <label class="form-label">Тип элемента</label>
                        <select class="form-select" id="itemTypeSelect" onchange="changeItemType()">
                            <option value="script">Скрипт</option>
                            <option value="router">Роутер</option>
                            <option value="setup">Настройка роутера</option>
                        </select>
                    </div>
                    <div id="scriptFields">
                        <div class="form-group">
                            <label class="form-label">Модель роутера</label>
                            <select class="form-select" id="scriptModel">
                                <option value="Общий скрипт">Общий скрипт</option>
                                <option value="Tenda TX 2 PRO">Tenda TX 2 PRO</option>
                                <option value="Tenda AC8">Tenda AC8</option>
                                <option value="Tenda AC5">Tenda AC5</option>
                                <option value="TP Link WR850N">TP Link WR850N</option>
                                <option value="Другая модель">Другая модель</option>
                            </select>
                        </div>
                        <div class="form-group" id="customModelGroup" style="display:none">
                            <label class="form-label">Название модели</label>
                            <input type="text" class="form-input" id="customModel" placeholder="Введите модель роутера">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Категория</label>
                            <select class="form-select" id="scriptCategory">
                                <option value="Диагностика">Диагностика</option>
                                <option value="Настройка">Настройка</option>
                                <option value="Проблемы">Проблемы сети</option>
                                <option value="Баланс">Баланс и платежи</option>
                                <option value="Техработы">Технические работы</option>
                                <option value="Аварии">Аварии и обрывы</option>
                                <option value="Подключение">Подключение услуг</option>
                                <option value="Информация">Общая информация</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Заголовок скрипта</label>
                            <input type="text" class="form-input" id="scriptTitle" placeholder="Краткое описание скрипта" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Текст скрипта</label>
                            <textarea class="form-textarea" id="scriptContent" placeholder="Введите текст скрипта..." required rows="6"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ключевые слова (через запятую)</label>
                            <input type="text" class="form-input" id="scriptTags" placeholder="скорость, интернет, wi-fi, баланс...">
                        </div>
                    </div>
                    <div id="routerFields" style="display:none">
                        <div class="form-group">
                            <label class="form-label">Модель роутера</label>
                            <input type="text" class="form-input" id="routerModel" placeholder="Например: Tenda TX 2 PRO" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Производитель</label>
                            <select class="form-select" id="routerBrand">
                                <option value="Tenda">Tenda</option>
                                <option value="TP-Link">TP-Link</option>
                                <option value="D-Link">D-Link</option>
                                <option value="Asus">Asus</option>
                                <option value="Huawei">Huawei</option>
                                <option value="Xiaomi">Xiaomi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Цена (руб.)</label>
                            <input type="number" class="form-input" id="routerPrice" placeholder="Например: 4800" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Диапазон Wi-Fi</label>
                            <select class="form-select" id="routerBand">
                                <option value="2.4 ГГц">2.4 ГГц</option>
                                <option value="5 ГГц">5 ГГц</option>
                                <option value="Двухдиапазонный">Двухдиапазонный</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Описание</label>
                            <textarea class="form-textarea" id="routerDescription" placeholder="Дополнительная информация о роутере..."></textarea>
                        </div>
                    </div>
                    <div id="setupFields" style="display:none">
                        <div class="form-group">
                            <label class="form-label">Производитель роутера</label>
                            <select class="form-select" id="setupBrand" required>
                                <option value="Tenda">Tenda</option>
                                <option value="TP-Link">TP-Link</option>
                                <option value="D-Link">D-Link</option>
                                <option value="Asus">Asus</option>
                                <option value="Huawei">Huawei</option>
                                <option value="Xiaomi">Xiaomi</option>
                                <option value="Keenetic">Keenetic</option>
                                <option value="Mercusys">Mercusys</option>
                                <option value="Qtech">Qtech</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Тип подключения</label>
                            <select class="form-select" id="setupConnectionType" required>
                                <option value="Динамический">Динамический IP</option>
                                <option value="PPPoE">PPPoE</option>
                                <option value="Статический">Статический IP</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Заголовок инструкции</label>
                            <input type="text" class="form-input" id="setupTitle" placeholder="Например: Настройка Tenda на динамический IP" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Пошаговая инструкция</label>
                            <textarea class="form-textarea" id="setupSteps" placeholder="Введите пошаговую инструкцию. Каждый шаг с новой строки..." rows="8" required></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal()">Отмена</button>
                <button class="btn btn-primary" onclick="saveItem()">Сохранить</button>
            </div>
        </div>
    </div>

    <!-- Уведомление -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i> 
        <span id="notificationText">Успешно!</span>
    </div>

    <script>
        // Базы данных с добавленными скриптами
        let scriptsDB = [
            // Существующие скрипты
            {id:1,model:"Общий скрипт",category:"Диагностика",title:"Нет MAC-адреса роутера",content:"Добрый день! Не видим сеть вашего роутера, перезагрузите устройство: выключить роутер из розетки на 2-3 минуты и в момент выключения вытащить и вставить кабель интернета и поставить в тот же разъем до щелчка. Так же проверьте, чтобы провод плотно стоял в терминале. Далее включите и минут через 5-10 проверьте.",tags:["мак-адрес","перезагрузка","диагностика"]},
            {id:2,model:"Общий скрипт",category:"Информация",title:"Отказ в подключении - нет техвозможности",content:"Когда перезваниваем: вы только что звонили по проведению интернета в п.Св.Путь, к сожалению, там нет такой тех.возможности.",tags:["подключение","техвозможность","отказ"]},
            {id:3,model:"Tenda AC8",category:"Диагностика",title:"Удаленная диагностика и перезагрузка",content:"Провели удаленную диагностику по Вашему адресу, с нашей стороны проблем обнаружено не было. Попробуйте отключить роутер из розетки на 3-5 мин и, в момент отключения, вытащить и вставить до щелчка оптический кабель из роутера. Затем вытащить и вставить аккуратно из основного оборудования (белой коробочки с лампочками). Далее включить роутер и проверить подключение через 5 минут.",tags:["диагностика","оптика","перезагрузка"]},
            {id:4,model:"Общий скрипт",category:"Диагностика",title:"Статус интернета активен",content:"Статус интернета у Вас активен. Проблем на линии не наблюдается. Если интернет так же не восстановился, пожалуйста попробуйте сделать перезагрузку всего вашего оборудования из розетки. Если ситуация не изменится, то обратитесь повторно",tags:["статус","перезагрузка","оборудование"]},
            {id:5,model:"Общий скрипт",category:"Баланс",title:"Переключение тарифа на 100 мб/с",content:"Добрый день! Переключили тариф на 100 мб/с. Для корректной работы услуг Вам следует пополнить свой баланс, чтобы он составлял 800 рублей. Так же для беспрерывной работы интернета, необходимо чтобы к первому числу каждого месяца на балансе были средства равные абонентской плате Вашего тарифа.",tags:["тариф","баланс","оплата"]},
            
            // Новые скрипты из предоставленного списка
            {id:6,model:"Общий скрипт",category:"Диагностика",title:"Проблем на линии нет, перезагрузка роутера",content:"Здравствуйте!\nНа текущий момент по линии компании - неполадок не наблюдаем, которые могут влиять на подключение.\nТрафик поступает исправно, сессию Вашего роутера наблюдаем в системе.\nПриостановок/отключений с нашей стороны не производилось.\n\nВ целях профилактики - сбросили текущую сессию, произведите перезагрузку роутера.",tags:["перезагрузка","сессия","профилактика"]},
            {id:7,model:"Общий скрипт",category:"Диагностика",title:"Порт отключен, проверка индикаторов",content:"Здравствуйте.\nПорт подключения по адресу наблюдаю как 'отключенный'.\nДо роутера должен быть установлен медиаконвертер с 6-тью индикаторами сбоку.\nСколько индикаторов из 6-ти сейчас горит?",tags:["порт","медиаконвертер","индикаторы"]},
            {id:8,model:"Общий скрипт",category:"Баланс",title:"Проверка баланса в личном кабинете",content:"Здравствуйте!\nПросматривать информацию о балансе вы можете через личный кабинет:\nПерейдите на сайт:\nhttps://slavyansk-na-kubani.soyka.su/\nИ выберите вкладку Личный кабинет:\nЛогин - номер договора\nПароль – запросите через 'Забыли пароль'(если забыли)",tags:["личный кабинет","баланс","пароль","сайт"]},
            {id:9,model:"Общий скрипт",category:"Диагностика",title:"Нет активной сессии роутера",content:"Здравствуйте!\nПо указанному Л/С оптический терминал фиксируем, он работает исправно.\nНо нет активной сессии от Вашего роутера, не наблюдаем МАС адрес устройства.\nБудьте добры, роутер сейчас перезагрузите пожалуйста + необходимо извлечь WAN кабель и после, вставить в то же самое гнездо до характерного щелчка.\nМы произведем повторную проверку.",tags:["сессия","mac-адрес","wan","перезагрузка"]},
            {id:10,model:"Общий скрипт",category:"Диагностика",title:"Нет физического линка",content:"Здравствуйте.\nФизического линка(подключения) по адресу не фиксируем.\nПерезагрузите сейчас роутер пожалуйста, так же проверьте плотно ли установлен кабель интернета.",tags:["линк","кабель","перезагрузка"]},
            {id:11,model:"Общий скрипт",category:"Техработы",title:"Работы по устранению просадок скорости",content:"На данный момент ведем ряд работ, направленных на устранение замечаний, связанных с обращениями по временным просадкам или потерям скорости, первый блок работ будет сдан в выходные, ситуация должна улучшиться. В долгосрочной перспективе (в течение месяца) запланирована сдача второго блока работ, ожидаем приход специализированного оборудования, после чего проведем апгрейд систем, для того чтобы исключить повторение подобных ситуаций.",tags:["работы","просадки","скорость","апгрейд"]},
            {id:12,model:"Общий скрипт",category:"Аварии",title:"Массовая приостановка коммутаторов",content:"Здравствуйте.\nФиксируем массовую приостановку коммутаторов по г. Славянск-на-Кубани.\nМонтажники прибыли на место поломки и оценив объем, ориентировочное время восстановления до 12:00.",tags:["массовая","коммутаторы","восстановление","авария"]},
            {id:13,model:"Общий скрипт",category:"Подключение",title:"Дом не подключен к сети",content:"Здравствуйте!\nЕсли это многоквартирный дом - к сожалению он не подключен к нашей компании.\nМы можем оформить заявку и проверить, возможно ли произвести там подключение.\nДля заявки потребуется:\n1. Контактный номер\n2. Точный адрес(Вы его уже назвали)\n3. ФИО\nК сожалению, обещать не можем - так как дом не подключен, однако если возможность к подключению будет, свяжемся с Вами.\nСрок рассмотрения заявки от 3 до 5 рабочих дней.",tags:["подключение","заявка","дом","адрес"]},
            {id:14,model:"Общий скрипт",category:"Аварии",title:"Проблемы у вышестоящего провайдера",content:"Здравствуйте! На данный момент неполадки у вышестоящего провайдера и наблюдаются перебои в предоставлении услуг связи (просадка скорости). Приносим извинения за доставленные неудобства, просим отнестись с пониманием.\nПопробуйте отключить роутер из розетки на 3-5 мин и, в момент отключения, вытащить и вставить до щелчка кабель с интернетом из роутера (порт подписан WAN или Internet). Далее включить роутер и проверить подключение через 5 минут.",tags:["провайдер","перебои","просадка","перезагрузка"]},
            {id:15,model:"Общий скрипт",category:"Проблемы",title:"Проблемы с приложениями и сервисами Google",content:"На текущий момент времени наблюдается проблема с использованием приложений, тесно связанных с сервисами Google.\nВозможны проблемы с загрузкой и просмотром видео через приложения: КиноПоиск, ИВИ и другие.\nПреимущественно проблема наблюдается на устройствах с ОС Android и AndroidTV.\nТакже, Роскомнадзор замедлил Ютуб по вcей РФ.",tags:["google","приложения","youtube","роскомнадзор"]},
            {id:16,model:"Общий скрипт",category:"Информация",title:"Блокировки VPN сервисов",content:"С нашей стороны к Вам предоставляется интернет услуга .\nВесь трафик проходит через государственное оборудование .\nВозможны блокировки VPN сервисах госструктур.",tags:["vpn","блокировки","трафик","государство"]},
            {id:17,model:"Общий скрипт",category:"Диагностика",title:"Замер скорости по кабелю",content:"По wi-fi всегда возможны погрешности.\nПроизведите замер скорости по прямому кабельному подключению (Через интернет кабель)\nПоказатели буду соответствовать тарифу.",tags:["скорость","кабель","wi-fi","замер"]},
            {id:18,model:"Общий скрипт",category:"Диагностика",title:"Проблема в интернет кабеле",content:"Возможно проблема в интернет кабеле.\nПопробуйте переподключить его к роутеру в тот же разъем WAN плотно до характерного щелчка.\nИ произведите повторный замер.",tags:["кабель","wan","переподключение","замер"]},
            {id:19,model:"Общий скрипт",category:"Проблемы",title:"Просадки скорости в вечернее время",content:"В вечерние время наблюдается проблема с посадками скорости.\nВедем работы по устранению данной проблемы.",tags:["вечер","скорость","просадки","работы"]},
            {id:20,model:"Общий скрипт",category:"Диагностика",title:"Не доступен коммутатор",content:"Наблюдаем, что у Вас не доступен коммутатор.\nИнформацию направили в системный отдел, так же направили заявку на бригаду.",tags:["коммутатор","бригада","системный отдел","заявка"]},
            {id:21,model:"Общий скрипт",category:"Аварии",title:"Обрыв линии - бригада в работе",content:"Добрый день.\nПроизошёл обрыв, ремонтная бригада уже занимается поиском и устранением.\nТочных сроков на данный момент пока не предоставили.\nПриносим извинения за временные неудобства.",tags:["обрыв","бригада","ремонт","сроки"]},
            {id:22,model:"Общий скрипт",category:"Информация",title:"Цены на роутеры",content:"Tenda TX 2 PRO – 4800р\nTenda AC8 – 3600р\nTenda AC5 – 3000р\nTP Link WR850N - 2000р",tags:["роутеры","цены","tenda","tp-link"]},
            {id:23,model:"Общий скрипт",category:"Информация",title:"Прекращение аналогового вещания",content:"Добрый день!\nНа текущий момент времени нет возможности исправить проблемы аналогово вещания.\nТак как его поддержка окончательно прекратилась в 2023 году.\nМинцифры перешли на цифровое вещание.\nЕсли ваш телевизор поддерживает цифровое вещание, то переключитесь на него.\nЕсли нет, то стоит приобрести тв приставку.\nПосле установки приставки, у вас будет 150 цифровых каналов в хорошем качестве за ту же ежемесячную оплату - 190р\nПриставку можете приобрести самостоятельно или у нас в офисе - 1200р",tags:["тв","аналог","цифра","приставка"]},
            {id:24,model:"Общий скрипт",category:"Диагностика",title:"Замер скорости через Яндекс",content:"https://yandex.ru/internet\nПроизведите замер скорости:\nПерейдите на сайт, нажмите старт, дождитесь завершения, пришлите результат.",tags:["скорость","яндекс","замер","сайт"]},
            {id:25,model:"Общий скрипт",category:"Информация",title:"Электронная почта компании",content:"office-tc@soyka.su",tags:["почта","email","контакты"]},
            {id:26,model:"Общий скрипт",category:"Информация",title:"Благодарность за информацию",content:"Благодарим за информацию.\nХорошего дня.",tags:["благодарность","информация","день"]},
            {id:27,model:"Общий скрипт",category:"Баланс",title:"Перерасчет за неработающие дни",content:"Доброе утро.\nПо договору, если проблема не решается в течение 10-ти календарных дней, Вы можете прийти в офис и написать заявление на перерасчет.",tags:["перерасчет","договор","заявление","офис"]},
            {id:28,model:"Общий скрипт",category:"Баланс",title:"Смена тарифа",content:"Доброе утро.\nВы можете сменить тариф в личном кабинете в разделе тех. поддержка, новый запрос, либо прийти в офис и написать заявление о смене тарифа.",tags:["тариф","смена","личный кабинет","заявление"]},
            {id:29,model:"Общий скрипт",category:"Баланс",title:"Обещанный платеж подключен",content:"Доброе утро.\nУслуга 'Обещанный платеж подключена'\nПроверьте работу интернета в течение 5-10 минут.",tags:["обещанный платеж","баланс","проверка"]},
            {id:30,model:"Общий скрипт",category:"Аварии",title:"Работы по устранению неполадок",content:"На данный момент зафиксированы обращения в вашей локации, ведем работы по выявлению неполадок и по устранению проблемы.\nЗаявку на выезд мастера уже оформили.",tags:["локация","работы","мастер","заявка"]},
            {id:31,model:"Общий скрипт",category:"Диагностика",title:"Проверка порта и сессии роутера",content:"Здравствуйте.\nПроизвели проверку по адресу.\nПорт подключения активен - роутер фиксируем в сети + активную сессию роутера.\nОграничений/приостановок/блокировок по линии компании не выявлено\nВ целях профилактики перезагрузили адрес дистанционно.\nПерезагрузите Ваш роутер пожалуйста с извлечением WAN кабеля(кабель после вставьте обратно до щелчка), после включения, через 5-7 минут проверьте статус работы услуги.",tags:["порт","сессия","профилактика","wan"]},
            {id:32,model:"Общий скрипт",category:"Аварии",title:"Отсутствие электропитания на серверной",content:"Здравствуйте.\nОбщая приостановка трафика в связи с отсутствием электропитания на серверой части(подключение от Маевского у Вас идет).\nИнформацию направили в системный отдел, ожидаем восстановления.",tags:["электричество","серверная","трафик","восстановление"]},
            {id:33,model:"Общий скрипт",category:"Аварии",title:"Отключение электроэнергии Россетями",content:"Добрый день.\nПо Вашей локации энергосбытовая компания произвела запланированное отключение электроэнергии, что затронуло наше узловое оборудование которое зависит от электричества. Пока не возобновят подачу электроэнергии Интернета не будет.",tags:["россети","электричество","оборудование","отключение"]},
            {id:34,model:"Общий скрипт",category:"Подключение",title:"Подключение интернета и ТВ в частном секторе",content:"Здравствуйте! Подключение стоит 3000 руб в частном секторе, но требуется рассмотрение технической возможности. Укажите пожалуйста ваш точный адрес, ФИО и контактный номер телефона. Помимо Интернета мы предлагаем подключить и Цифровое ТВ с архивом передач за 2 недели и большим количеством каналов, у нас есть очень выгодные пакетные тарифы Интернет +ТВ. Для подключения Цифрового ТВ необходимо, чтобы телевизор поддерживал функцию СМАРТ, либо в наличии была смарт-приставка.",tags:["подключение","тв","частный сектор","тарифы"]},
            {id:35,model:"Общий скрипт",category:"Подключение",title:"Акция 'Перемены к лучшему'",content:"Приглашаем Вас поучаствовать в акции - 'Перемены к лучшему'! При подключении к нашей сети мы подарим Вам гарантированный подарок — кухонные весы. Это многофункциональное устройство поможет вам следить за питанием и готовить с большей точностью. Помимо этого, Вы автоматически попадаете в розыгрыш - каждый месяц в рамках нашей акции мы проводим розыгрыши полезных призов, таких как пылесосы, термопоты, запасы чая и мультипечи , который будет проводиться онлайн в наших группах: Славянск https://vk.com/soyka_slavaynsk, Темрюк: https://vk.com/soyka_temruk, Крымск https://vk.com/soyka_krymsk",tags:["акция","подарок","розыгрыш","подключение"]},
            {id:36,model:"Общий скрипт",category:"Информация",title:"Тарифы на сайте компании",content:"Тарифы имеются на сайте компании - https://slavyansk-na-kubani.soyka.su/",tags:["тарифы","сайт","информация"]},
            {id:37,model:"Общий скрипт",category:"Аварии",title:"Сгорел трансформатор в Голубицкой",content:"Сгорел трансформатор по ст. Голубицкая.\nБригада на текущий момент ведет восстановление.\nБригада уже на месте, ведет работы.\nОжидаем завершение работ в первую половину дня.",tags:["трансформатор","голубицкая","бригада","восстановление"]},
            {id:38,model:"Общий скрипт",category:"Аварии",title:"Перегорел провод по Восточной 8",content:"Добрый день.\nПерегорел провод по Восточной 8.\nРоссети в курсе о данной проблеме.\nБригада уже на месте, ведет работы.",tags:["провод","восточная","россети","бригада"]},
            {id:39,model:"Общий скрипт",category:"Информация",title:"Нецензурная лексика в обращении",content:"Все диалоги записываются. В вашем обращении используется нецензурная лексика. Вынужден(а) закрыть данный диалог.",tags:["нецензурная лексика","диалог","закрытие"]},
            {id:40,model:"Общий скрипт",category:"Диагностика",title:"Рекомендация по кабельному подключению",content:"Рекомендуется делать не через Wi-Fi подключение, а через кабельное интернет подключение.",tags:["кабель","wi-fi","рекомендация","подключение"]},
            {id:41,model:"Общий скрипт",category:"Диагностика",title:"Диагностика пингованием",content:"Пингование:\n\n1. Нажать WIN + R и в появившееся окно написать: cmd\n2. Запустить от имени администратора\n3. Появится черное окно 'консоль' внутри которой необходимо задать команду: ping ya.ru -t и нажать Enter\n\nСистема запустит неограниченный обмен пакетами, в которых также будет отображаться пинг. Характерный обрыв как правило выделяется 'Превышено ожидание запроса пакета' - примерно такой текст будет свидетельствовать об обрыве",tags:["пинг","диагностика","cmd","команды"]},
            {id:42,model:"Общий скрипт",category:"Диагностика",title:"Пинг до роутера",content:"До роутера:\n\n1. Нажать WIN + R и в появившееся окно написать: cmd\n2. Запустить от имени администратора\n3. Появится черное окно 'консоль' внутри которой необходимо задать команду: ping 192.168.1.1 (изменить если в трассировке увидишь другой IP роутера) -t и нажать Enter",tags:["пинг","роутер","ip","диагностика"]},
            {id:43,model:"Общий скрипт",category:"Техработы",title:"Модернизация оборудования",content:"Добрый день.\nСегодня с 8:30 до 15:00 мы проводим модернизацию нашего оборудования. Это необходимо для улучшения качества предоставляемых услуг.\nВо время проведения данных работ, может наблюдаться частичная или полная потеря соединения с доступом в интернет и с кабельным ТВ.\nПросим вас набрась терпения и дождаться восстановления услуги в полном объеме.",tags:["модернизация","оборудование","работы","тв"]},
            {id:44,model:"Общий скрипт",category:"Аварии",title:"Отсутствие кабельного вещания",content:"Добрый день.\nВ настоящее время поступает множество обращений, связанных с отсутствием кабельного вещания. Наши специалисты уже работают над решением данной проблемы. В ближайшее время вещание восстановится. Приносим искренние извинения за возможные неудобства, вызванные временным отсутствием доступа к просмотру.",tags:["тв","вещание","обращения","восстановление"]},
            {id:45,model:"Общий скрипт",category:"Аварии",title:"Аварийная ситуация",content:"Здравствуйте! В данный момент аварийная ситуация, ведутся работы по устранению данной проблемы. Точного времени решения не установлено. Приносим извинения за временные неудобства.",tags:["авария","работы","время","извинения"]},
            {id:46,model:"Общий скрипт",category:"Аварии",title:"Обрыв оптоволокна на столбах",content:"Здравствуйте! В данный момент аварийная ситуация, на столбах в вашей локации произошёл обрыв оптоволокна. Мы уже отправили монтажную бригаду для восстановления линии. Срок решения - сегодня до 17:00. Приносим извинения за предоставленные неудобства. Пожалуйста, ожидайте.",tags:["оптоволокно","обрыв","бригада","сроки"]},
            {id:47,model:"Общий скрипт",category:"Диагностика",title:"Команды для диагностики игровых проблем",content:"1. Выполните команду ping до роутера\nОткройте cmd(командная строка).\nВведите и выполните команду:\nping {ip роутера без скобочек} -n 100\nПояснение: \n'-n' - кол-во обращений для обмена пакетами.\nПроверим, есть ли потери на данном этапе.\n\n2. Выполните команду ping до сервера игры (Найти сервера можете на соответствующих форумах и выбрать подходящий вам).\nКоманда:\nping {адрес сервера без скобочек} -n 300\n(можно больше, можно меньше, но лучше, чтоб обмен шёл подольше).\nДля проверки потерь на данном этапе.\n\n3. Выполните трассировку до сервера игры.\nКоманда:\ntracert {адрес сервера без скобочек} и дождитесь сообщения 'Трассировка завершена.'\n\n4. Выполните команду ping до яндекса:\nКоманда:\nping ya.ru –n 300\n\nРезультаты можете скопировать и сохранить в блокнот(либо сделать скриншоты), после отослать нам в чат.\nТрассировка нужна полностью.\nОт пингов только результат(Статистика Ping и Приблизительное время приема-передачи в мс)\n(сводка предоставляется после завершения обмена пакетами)",tags:["игры","пинг","трассировка","диагностика"]},
            {id:48,model:"Общий скрипт",category:"Аварии",title:"Выявлен обрыв кабеля",content:"Здравствуйте.\nВыявлен обрыв кабеля.\nЗаявка оформлена.",tags:["обрыв","кабель","заявка"]},
            {id:49,model:"Общий скрипт",category:"Баланс",title:"Повышение цен и блокировка",content:"Было повышение цен, Вам на почту присылали письмо с оповещением.\nНа данный момент у Вас блокировка из-за нехватки средств.",tags:["цены","блокировка","баланс","оповещение"]},
            {id:50,model:"Общий скрипт",category:"Подключение",title:"Акция по подключению",content:"Сейчас у нас проходит акция по подключению. Если вы пополните свой счет на 2000 рублей и подключите пакетный тариф или скорость 100 Мбит/с, то эти деньги будут зачислены на ваш счет и затем использованы для списания абонентской платы, а подключение будет бесплатным!\n\nДля уточнения, пожалуйста, сообщите ваш полный адрес, ФИО и контактный номер телефона.\n\nОбратите внимание, что возможность подключения будет рассматриваться в течение 5-7 рабочих дней. После этого с вами свяжется наш абонентский отдел.\n\nСпасибо за ваш интерес! Ждём вашего ответа.",tags:["акция","подключение","тариф","бесплатно"]},
            {id:51,model:"Общий скрипт",category:"Техработы",title:"Технические работы в локации",content:"что в вашей локации проводятся технические работы, которые могут временно повлиять на качество предоставляемого интернета. К сожалению, точное время окончания работ мы не можем указать.\n\nПриносим извинения за возможные неудобства и благодарим вас за понимание. Мы прилагаем все усилия, чтобы улучшить качество наших услуг для вас.",tags:["работы","локация","качество","извинения"]},
            {id:52,model:"Общий скрипт",category:"Информация",title:"Оповещение о повышении цен",content:"Мы Вас оповещали : в соц. сетях, телефонии так же на сайте.\n\nС данной информацией Вы можете ознакомиться здесь: https://slavyansk-na-kubani.soyka.su/knowledge/novosti-kompanii-soyka/obnovlenie-stoimosti-tarifov-g-slavyansk-na-kubani-g-temryuk-s-1-fevralya-2025-g/",tags:["цены","оповещение","сайт","информация"]},
            {id:53,model:"Общий скрипт",category:"Аварии",title:"Обращения в локации - работы ведутся",content:"На данный момент зафиксированы обращения в вашей локации, ведем работы по выявлению неполадок и по устранению проблемы.\nВ ближайшее время работа интернета будет восстановлена.\nПриносим извинения за доставленные неудобства.",tags:["локация","работы","восстановление","извинения"]},
            {id:54,model:"Общий скрипт",category:"Аварии",title:"Проблемы в локации - время неизвестно",content:"На данный момент зафиксированы обращения в вашей локации, ведем работы по устранению проблемы.\nВремя восстановления, не известно.\nПриносим извинения за доставленные неудобства.",tags:["локация","время","восстановление","извинения"]},
            {id:55,model:"Общий скрипт",category:"Техработы",title:"Модернизация оборудования с 8:30 до 15:00",content:"Здравствуйте!\nСегодня с 8:30 до 15:00 мы проводим модернизацию нашего оборудования. Это необходимо для улучшения качества предоставляемых услуг!\nВо время проведения данных работ, может наблюдаться частичная или полная потеря соединения с доступом в интернет и с кабельным ТВ.\nПросим вас набраться терпения и дождаться восстановления услуги в полном объеме.",tags:["модернизация","оборудование","время","тв"]},
            {id:56,model:"Общий скрипт",category:"Аварии",title:"Массовая проблема",content:"Здравствуйте!\nНаблюдаем, что это массовая проблема.\nЗаявку передали в системный отдел, и инженеру.\nОжидайте восстановление в течение дня.",tags:["массовая","проблема","инженер","восстановление"]},
            {id:57,model:"Общий скрипт",category:"Баланс",title:"Блокировка из-за нехватки средств",content:"Здравствуйте!\nНаблюдаем, что у Вас блокировка из-за нехватки средств.\nС 01.02.2025г. Ваша абонентская плата 960 рублей.\nВаш баланс : 900 рублей.",tags:["блокировка","баланс","абонплата","нехватка"]},
            {id:58,model:"Общий скрипт",category:"Информация",title:"Имя специалиста",content:"Владимир Сергеевич , это имя и отчество специалиста, который сейчас с Вами общается)",tags:["имя","специалист","общение"]},
            {id:59,model:"Общий скрипт",category:"Диагностика",title:"Пингование через командную строку",content:"Пингование:\n\n1. Нажать WIN + R и в появившееся окно написать: cmd\n2. Запустить от имени администратора\n3. Появится черное окно 'консоль' внутри которой необходимо задать команду: ping ya.ru -t и нажать Enter\n                    \nСистема запустит неограниченный обмен пакетами, в которых также будет отображаться пинг. Характерный обрыв как правило выделяется 'Превышено ожидание запроса пакета' - примерно такой текст будет свидетельствовать об обрыве",tags:["пинг","cmd","командная строка","диагностика"]},
            {id:60,model:"Общий скрипт",category:"Диагностика",title:"Пинг до роутера через командную строку",content:"До роутера:\n\n1. Нажать WIN + R и в появившееся окно написать: cmd\n2. Запустить от имени администратора\n3. Появится черное окно 'консоль' внутри которой необходимо задать команду: ping 192.168.1.1 (изменить если в трассировке увидишь другой IP роутера) -t и нажать Enter",tags:["пинг","роутер","cmd","ip"]}
        ];

        let routersDB = [
            {id:1,model:"Tenda TX 2 PRO",brand:"Tenda",price:4800,band:"Двухдиапазонный",speed:"1501 Мбит/с",description:"Wi-Fi 6 роутер с высокой скоростью и стабильным соединением."},
            {id:2,model:"Tenda AC8",brand:"Tenda",price:3600,band:"Двухдиапазонный",speed:"1000 Мбит/с",description:"Двухдиапазонный роутер с хорошим покрытием и гигабитными портами."},
            {id:3,model:"Tenda AC5",brand:"Tenda",price:3000,band:"2.4 ГГц",speed:"300 Мбит/с",description:"Бюджетный роутер для базовых потребностей."},
            {id:4,model:"TP Link WR850N",brand:"TP-Link",price:2000,band:"2.4 ГГц",speed:"300 Мбит/с",description:"Надежный роутер с стабильным сигналом."},
            {id:5,model:"Asus RT-AX55",brand:"Asus",price:5500,band:"Wi-Fi 6",speed:"1800 Мбит/с",description:"Wi-Fi 6 роутер с поддержкой Mesh системы."},
            {id:6,model:"Xiaomi Mi Router 4A",brand:"Xiaomi",price:2500,band:"Двухдиапазонный",speed:"1200 Мбит/с",description:"Стильный и производительный роутер от Xiaomi."},
            {id:7,model:"D-Link DIR-615",brand:"D-Link",price:1800,band:"2.4 ГГц",speed:"300 Мбит/с",description:"Классический надежный роутер для дома."},
            {id:8,model:"Huawei AX3",brand:"Huawei",price:4000,band:"Wi-Fi 6",speed:"3000 Мбит/с",description:"Wi-Fi 6 роутер с технологией Huawei Wi-Fi 6+."}
        ];

        let setupsDB = [
            {id:1,brand:"Tenda",type:"Динамический",title:"Настройка роутера Tenda на динамический IP",steps:["Шаг 1: Подключение роутера","Шаг 2: Доступ к веб-интерфейсу","Шаг 3: Выбор типа подключения","Шаг 4: Настройка динамического IP","Шаг 5: Проверка подключения","Шаг 6: Настройка Wi-Fi","Шаг 7: Перезагрузка","Шаг 8: Завершение настройки"]},
            {id:2,brand:"TP-Link",type:"Динамический",title:"Настройка роутера TP-Link на динамический IP",steps:["Шаг 1: Подключение роутера","Шаг 2: Открытие веб-интерфейса","Шаг 3: Вход в систему","Шаг 4: Настройка подключения","Шаг 5: Установка параметров DHCP","Шаг 6: Сохранение настроек","Шаг 7: Проверка подключения","Шаг 8: Настройка Wi-Fi","Шаг 9: Сохранение настроек"]}
        ];

        // Статистика копирований
        let copyStats = {
            today: 0,
            total: 0,
            lastUpdate: new Date().toLocaleDateString('ru-RU')
        };

        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            renderScripts();
            renderRouters();
            renderSetups();
            updateStats();
            setupEventListeners();
            setupNavigation();
            
            // Установка текущей даты
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('ru-RU');
            
            // Кнопка наверх
            const scrollTopBtn = document.getElementById('scrollTop');
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    scrollTopBtn.style.display = 'flex';
                } else {
                    scrollTopBtn.style.display = 'none';
                }
            });
            
            scrollTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Горячие клавиши
            document.addEventListener('keydown', handleKeyboardShortcuts);
        });

        function loadFromLocalStorage() {
            const savedScripts = localStorage.getItem('soykaScriptsDB');
            if (savedScripts) scriptsDB = JSON.parse(savedScripts);
            
            const savedRouters = localStorage.getItem('soykaRoutersDB');
            if (savedRouters) routersDB = JSON.parse(savedRouters);
            
            const savedSetups = localStorage.getItem('soykaSetupsDB');
            if (savedSetups) setupsDB = JSON.parse(savedSetups);
            
            const savedStats = localStorage.getItem('soykaCopyStats');
            if (savedStats) copyStats = JSON.parse(savedStats);
        }

        function setupNavigation() {
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (btn.dataset.section) {
                    btn.addEventListener('click', function() {
                        switchSection(this.dataset.section);
                    });
                }
            });
            
            // Сделать все кнопки в футере кликабельными
            document.querySelectorAll('.footer-link').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
        }

        function switchSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.section === sectionId || 
                    (sectionId === 'scripts' && btn.classList.contains('home-btn'))) {
                    btn.classList.add('active');
                }
            });
            
            // Показать/скрыть быстрые действия
            const quickActions = document.getElementById('quickActions');
            if (sectionId === 'scripts') {
                quickActions.style.display = 'grid';
            } else {
                quickActions.style.display = 'none';
            }
            
            if (sectionId === 'stats') updateStats();
            
            // Плавная прокрутка вверх
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function renderScripts(filtered = null) {
            const items = filtered || scriptsDB;
            const container = document.getElementById('scriptsContainer');
            
            if (items.length === 0) {
                container.innerHTML = '';
                document.getElementById('emptyState').style.display = 'block';
                return;
            }
            
            document.getElementById('emptyState').style.display = 'none';
            
            container.innerHTML = items.map(item => `
                <div class="script-card card" data-id="${item.id}">
                    <div class="card-header script-header">
                        <div class="card-model">${item.model}</div>
                        <div class="card-badge">${item.category}</div>
                    </div>
                    <div class="card-content">
                        <h4 style="margin-bottom:1rem;color:var(--primary);font-weight:600">${item.title}</h4>
                        <div class="script-text">${formatScriptContent(item.content)}</div>
                        ${item.tags && item.tags.length > 0 ? `
                            <div class="script-tags">${item.tags.map(t => `<span class="tag">${t}</span>`).join('')}</div>
                        ` : ''}
                    </div>
                    <div class="card-actions">
                        <button class="icon-btn copy" onclick="copyScript(${item.id})" title="Копировать скрипт" aria-label="Копировать">
                            <i class="far fa-copy"></i>
                        </button>
                        <button class="icon-btn edit" onclick="editItem('script',${item.id})" title="Редактировать" aria-label="Редактировать">
                            <i class="far fa-edit"></i>
                        </button>
                        <button class="icon-btn delete" onclick="deleteItem('script',${item.id})" title="Удалить" aria-label="Удалить">
                            <i class="far fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function formatScriptContent(content) {
            // Заменяем URL на кликабельные ссылки
            let formatted = content.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" class="url-link">$1</a>');
            // Добавляем переносы строк
            formatted = formatted.replace(/\n/g, '<br>');
            return formatted;
        }

        function renderRouters(filtered = null) {
            const items = filtered || routersDB;
            const container = document.getElementById('routersContainer');
            
            if (items.length === 0) {
                container.innerHTML = '';
                document.getElementById('emptyState').style.display = 'block';
                return;
            }
            
            document.getElementById('emptyState').style.display = 'none';
            
            container.innerHTML = items.map(item => `
                <div class="router-card card" data-id="${item.id}">
                    <div class="card-header router-header">
                        <div class="card-model">${item.model}</div>
                        <div class="router-price">${item.price} руб.</div>
                    </div>
                    <div class="card-content">
                        <ul class="router-specs">
                            <li><span class="spec-label">Производитель:</span><span class="spec-value">${item.brand}</span></li>
                            <li><span class="spec-label">Диапазон Wi-Fi:</span><span class="spec-value">${item.band}</span></li>
                            ${item.speed ? `<li><span class="spec-label">Скорость Wi-Fi:</span><span class="spec-value">${item.speed}</span></li>` : ''}
                        </ul>
                        ${item.description ? `<div style="font-size:0.9rem;color:var(--text-light);margin-top:1rem">${item.description}</div>` : ''}
                    </div>
                    <div class="card-actions">
                        <button class="icon-btn edit" onclick="editItem('router',${item.id})" title="Редактировать" aria-label="Редактировать">
                            <i class="far fa-edit"></i>
                        </button>
                        <button class="icon-btn delete" onclick="deleteItem('router',${item.id})" title="Удалить" aria-label="Удалить">
                            <i class="far fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderSetups(filtered = null) {
            const items = filtered || setupsDB;
            const container = document.getElementById('setupsContainer');
            
            if (items.length === 0) {
                container.innerHTML = '';
                document.getElementById('emptyState').style.display = 'block';
                return;
            }
            
            document.getElementById('emptyState').style.display = 'none';
            
            container.innerHTML = items.map(item => `
                <div class="setup-card card" data-id="${item.id}">
                    <div class="card-header setup-header">
                        <div class="card-brand">${item.brand}</div>
                        <div class="setup-badge">${item.type}</div>
                    </div>
                    <div class="card-content">
                        <h4 style="margin-bottom:1rem;color:var(--primary);font-weight:600">${item.title}</h4>
                        <ul class="setup-steps">
                            ${item.steps.map((s,i) => `<li>
                                <div class="step-number">${i+1}</div>
                                <div class="step-text">
                                    <div class="step-title">${s.split(':')[0] || 'Шаг'}:</div>
                                    <div>${s.split(':').slice(1).join(':') || s}</div>
                                </div>
                            </li>`).join('')}
                        </ul>
                    </div>
                    <div class="card-actions">
                        <button class="icon-btn copy" onclick="copySetup(${item.id})" title="Копировать инструкцию" aria-label="Копировать">
                            <i class="far fa-copy"></i>
                        </button>
                        <button class="icon-btn edit" onclick="editItem('setup',${item.id})" title="Редактировать" aria-label="Редактировать">
                            <i class="far fa-edit"></i>
                        </button>
                        <button class="icon-btn delete" onclick="deleteItem('setup',${item.id})" title="Удалить" aria-label="Удалить">
                            <i class="far fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function setupEventListeners() {
            // Поиск скриптов
            const searchScripts = document.getElementById('searchScripts');
            searchScripts.addEventListener('input', filterScripts);
            searchScripts.addEventListener('focus', function() {
                this.style.borderColor = 'var(--primary)';
            });
            searchScripts.addEventListener('blur', function() {
                this.style.borderColor = '';
            });
            
            // Фильтры скриптов
            document.getElementById('filterScriptModel').addEventListener('change', filterScripts);
            document.getElementById('filterScriptCategory').addEventListener('change', filterScripts);
            document.getElementById('filterScriptType').addEventListener('change', filterScripts);
            
            // Поиск роутеров
            document.getElementById('searchRouters').addEventListener('input', filterRouters);
            document.getElementById('filterRouterBrand').addEventListener('change', filterRouters);
            document.getElementById('filterRouterBand').addEventListener('change', filterRouters);
            document.getElementById('filterRouterPrice').addEventListener('change', filterRouters);
            
            // Поиск настроек
            document.getElementById('searchSetups').addEventListener('input', filterSetups);
            document.getElementById('filterSetupBrand').addEventListener('change', filterSetups);
            document.getElementById('filterSetupType').addEventListener('change', filterSetups);
            
            // Кастомная модель в модальном окне
            document.getElementById('scriptModel').addEventListener('change', function() {
                document.getElementById('customModelGroup').style.display = this.value === 'Другая модель' ? 'block' : 'none';
            });
            
            // Улучшенная кликабельность для всех кнопок
            document.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('mousedown', function() {
                    this.style.transform = 'scale(0.98)';
                });
                btn.addEventListener('mouseup', function() {
                    this.style.transform = '';
                });
                btn.addEventListener('mouseleave', function() {
                    this.style.transform = '';
                });
            });
        }

        function filterScripts() {
            const searchTerm = document.getElementById('searchScripts').value.toLowerCase();
            const modelFilter = document.getElementById('filterScriptModel').value;
            const categoryFilter = document.getElementById('filterScriptCategory').value;
            const typeFilter = document.getElementById('filterScriptType').value;
            
            const filtered = scriptsDB.filter(script => {
                const matchesSearch = !searchTerm || 
                    script.title.toLowerCase().includes(searchTerm) ||
                    script.content.toLowerCase().includes(searchTerm) ||
                    (script.tags && script.tags.some(tag => tag.toLowerCase().includes(searchTerm))) ||
                    script.model.toLowerCase().includes(searchTerm);
                
                const matchesModel = !modelFilter || script.model === modelFilter;
                const matchesCategory = !categoryFilter || script.category === categoryFilter;
                const matchesType = !typeFilter || 
                    (typeFilter === 'Динамический' && script.category === 'Диагностика') ||
                    (typeFilter === 'Скорость' && (script.tags && script.tags.some(tag => ['скорость', 'просадки'].includes(tag)))) ||
                    (typeFilter === 'TV' && (script.tags && script.tags.some(tag => ['тв', 'телевизор'].includes(tag))));
                
                return matchesSearch && matchesModel && matchesCategory && matchesType;
            });
            
            renderScripts(filtered);
        }

        function filterRouters() {
            const searchTerm = document.getElementById('searchRouters').value.toLowerCase();
            const brandFilter = document.getElementById('filterRouterBrand').value;
            const bandFilter = document.getElementById('filterRouterBand').value;
            const priceFilter = document.getElementById('filterRouterPrice').value;
            
            const filtered = routersDB.filter(router => {
                const matchesSearch = !searchTerm || 
                    router.model.toLowerCase().includes(searchTerm) ||
                    router.brand.toLowerCase().includes(searchTerm) ||
                    (router.description && router.description.toLowerCase().includes(searchTerm));
                
                const matchesBrand = !brandFilter || router.brand === brandFilter;
                const matchesBand = !bandFilter || router.band === bandFilter;
                const matchesPrice = !priceFilter || (
                    priceFilter === 'до 3000' && router.price <= 3000 ||
                    priceFilter === '3000-5000' && router.price >= 3000 && router.price <= 5000 ||
                    priceFilter === 'от 5000' && router.price >= 5000
                );
                
                return matchesSearch && matchesBrand && matchesBand && matchesPrice;
            });
            
            renderRouters(filtered);
        }

        function filterSetups() {
            const searchTerm = document.getElementById('searchSetups').value.toLowerCase();
            const brandFilter = document.getElementById('filterSetupBrand').value;
            const typeFilter = document.getElementById('filterSetupType').value;
            
            const filtered = setupsDB.filter(setup => {
                const matchesSearch = !searchTerm || 
                    setup.title.toLowerCase().includes(searchTerm) ||
                    setup.brand.toLowerCase().includes(searchTerm);
                
                const matchesBrand = !brandFilter || setup.brand === brandFilter;
                const matchesType = !typeFilter || setup.type === typeFilter;
                
                return matchesSearch && matchesBrand && matchesType;
            });
            
            renderSetups(filtered);
        }

        function clearFilters() {
            document.getElementById('searchScripts').value = '';
            document.getElementById('filterScriptModel').selectedIndex = 0;
            document.getElementById('filterScriptCategory').selectedIndex = 0;
            document.getElementById('filterScriptType').selectedIndex = 0;
            renderScripts();
            showNotification('Фильтры сброшены');
        }

        let editingId = null;
        let currentItemType = 'script';
        
        function openModal(itemType = 'script', item = null) {
            editingId = item ? item.id : null;
            currentItemType = itemType;
            
            document.getElementById('itemTypeSelect').value = itemType;
            changeItemType();
            
            document.getElementById('modalTitle').textContent = 
                item ? `Редактировать ${getItemTypeName(itemType)}` : 
                       `Добавить ${getItemTypeName(itemType)}`;
            
            if (item) {
                document.getElementById('itemId').value = item.id;
                document.getElementById('itemType').value = itemType;
                
                if (itemType === 'script') {
                    document.getElementById('scriptModel').value = item.model === 'Другая модель' ? 'Другая модель' : item.model;
                    document.getElementById('customModel').value = item.model === 'Другая модель' ? '' : item.model;
                    document.getElementById('customModelGroup').style.display = item.model === 'Другая модель' ? 'block' : 'none';
                    document.getElementById('scriptCategory').value = item.category;
                    document.getElementById('scriptTitle').value = item.title;
                    document.getElementById('scriptContent').value = item.content;
                    document.getElementById('scriptTags').value = item.tags ? item.tags.join(', ') : '';
                } else if (itemType === 'router') {
                    document.getElementById('routerModel').value = item.model;
                    document.getElementById('routerBrand').value = item.brand;
                    document.getElementById('routerPrice').value = item.price;
                    document.getElementById('routerBand').value = item.band;
                    document.getElementById('routerSpeed').value = item.speed || '';
                    document.getElementById('routerDescription').value = item.description || '';
                } else if (itemType === 'setup') {
                    document.getElementById('setupBrand').value = item.brand;
                    document.getElementById('setupConnectionType').value = item.type;
                    document.getElementById('setupTitle').value = item.title;
                    document.getElementById('setupSteps').value = Array.isArray(item.steps) ? item.steps.join('\n') : '';
                }
            } else {
                document.getElementById('scriptForm').reset();
                document.getElementById('customModelGroup').style.display = 'none';
                document.getElementById('itemId').value = '';
            }
            
            document.getElementById('scriptModal').style.display = 'flex';
            document.getElementById('scriptModal').style.alignItems = 'center';
            document.getElementById('scriptModal').style.justifyContent = 'center';
        }

        function getItemTypeName(type) {
            const names = {
                'script': 'скрипт',
                'router': 'роутер',
                'setup': 'настройку'
            };
            return names[type] || 'элемент';
        }

        function changeItemType() {
            const itemType = document.getElementById('itemTypeSelect').value;
            currentItemType = itemType;
            
            document.getElementById('scriptFields').style.display = 'none';
            document.getElementById('routerFields').style.display = 'none';
            document.getElementById('setupFields').style.display = 'none';
            
            if (itemType === 'script') {
                document.getElementById('scriptFields').style.display = 'block';
            } else if (itemType === 'router') {
                document.getElementById('routerFields').style.display = 'block';
            } else if (itemType === 'setup') {
                document.getElementById('setupFields').style.display = 'block';
            }
            
            // Обновить заголовок
            const isEditing = editingId !== null;
            document.getElementById('modalTitle').textContent = 
                isEditing ? `Редактировать ${getItemTypeName(itemType)}` : 
                           `Добавить ${getItemTypeName(itemType)}`;
        }

        function closeModal() {
            document.getElementById('scriptModal').style.display = 'none';
            editingId = null;
        }

        function saveItem() {
            if (currentItemType === 'script') saveScript();
            else if (currentItemType === 'router') saveRouter();
            else if (currentItemType === 'setup') saveSetup();
        }

        function saveScript() {
            const modelSelect = document.getElementById('scriptModel').value;
            const model = modelSelect === 'Другая модель' 
                ? document.getElementById('customModel').value 
                : modelSelect;
            
            if (!model || !document.getElementById('scriptTitle').value || !document.getElementById('scriptContent').value) {
                showNotification('Заполните обязательные поля!', 'error');
                return;
            }
            
            const script = {
                id: editingId || Date.now(),
                model: model || 'Общий скрипт',
                category: document.getElementById('scriptCategory').value,
                title: document.getElementById('scriptTitle').value,
                content: document.getElementById('scriptContent').value,
                tags: document.getElementById('scriptTags').value.split(',').map(tag => tag.trim()).filter(tag => tag)
            };
            
            if (editingId) {
                const index = scriptsDB.findIndex(s => s.id === editingId);
                scriptsDB[index] = script;
                showNotification('Скрипт успешно обновлен!');
            } else {
                scriptsDB.unshift(script);
                showNotification('Скрипт успешно добавлен!');
            }
            
            localStorage.setItem('soykaScriptsDB', JSON.stringify(scriptsDB));
            renderScripts();
            closeModal();
            filterScripts();
            updateStats();
        }

        function saveRouter() {
            if (!document.getElementById('routerModel').value || !document.getElementById('routerPrice').value) {
                showNotification('Заполните обязательные поля!', 'error');
                return;
            }
            
            const router = {
                id: editingId || Date.now(),
                model: document.getElementById('routerModel').value,
                brand: document.getElementById('routerBrand').value,
                price: parseInt(document.getElementById('routerPrice').value),
                band: document.getElementById('routerBand').value,
                speed: document.getElementById('routerSpeed').value || '',
                description: document.getElementById('routerDescription').value || ''
            };
            
            if (editingId) {
                const index = routersDB.findIndex(r => r.id === editingId);
                routersDB[index] = router;
                showNotification('Роутер успешно обновлен!');
            } else {
                routersDB.unshift(router);
                showNotification('Роутер успешно добавлен!');
            }
            
            localStorage.setItem('soykaRoutersDB', JSON.stringify(routersDB));
            renderRouters();
            closeModal();
            filterRouters();
            updateStats();
        }

        function saveSetup() {
            if (!document.getElementById('setupBrand').value || !document.getElementById('setupTitle').value || !document.getElementById('setupSteps').value) {
                showNotification('Заполните обязательные поля!', 'error');
                return;
            }
            
            const steps = document.getElementById('setupSteps').value.split('\n')
                .map(step => step.trim())
                .filter(step => step.length > 0);
            
            if (steps.length === 0) {
                showNotification('Добавьте хотя бы один шаг!', 'error');
                return;
            }
            
            const setup = {
                id: editingId || Date.now(),
                brand: document.getElementById('setupBrand').value,
                type: document.getElementById('setupConnectionType').value,
                title: document.getElementById('setupTitle').value,
                steps: steps
            };
            
            if (editingId) {
                const index = setupsDB.findIndex(s => s.id === editingId);
                setupsDB[index] = setup;
                showNotification('Настройка успешно обновлена!');
            } else {
                setupsDB.unshift(setup);
                showNotification('Настройка успешно добавлена!');
            }
            
            localStorage.setItem('soykaSetupsDB', JSON.stringify(setupsDB));
            renderSetups();
            closeModal();
            filterSetups();
            updateStats();
        }

        function editItem(type, id) {
            let item;
            if (type === 'script') item = scriptsDB.find(s => s.id === id);
            else if (type === 'router') item = routersDB.find(r => r.id === id);
            else if (type === 'setup') item = setupsDB.find(s => s.id === id);
            
            if (item) openModal(type, item);
        }

        function deleteItem(type, id) {
            if (!confirm('Вы уверены, что хотите удалить этот элемент?')) return;
            
            let removed = false;
            if (type === 'script') {
                const initialLength = scriptsDB.length;
                scriptsDB = scriptsDB.filter(s => s.id !== id);
                removed = scriptsDB.length < initialLength;
                localStorage.setItem('soykaScriptsDB', JSON.stringify(scriptsDB));
                renderScripts();
                filterScripts();
            } else if (type === 'router') {
                const initialLength = routersDB.length;
                routersDB = routersDB.filter(r => r.id !== id);
                removed = routersDB.length < initialLength;
                localStorage.setItem('soykaRoutersDB', JSON.stringify(routersDB));
                renderRouters();
                filterRouters();
            } else if (type === 'setup') {
                const initialLength = setupsDB.length;
                setupsDB = setupsDB.filter(s => s.id !== id);
                removed = setupsDB.length < initialLength;
                localStorage.setItem('soykaSetupsDB', JSON.stringify(setupsDB));
                renderSetups();
                filterSetups();
            }
            
            if (removed) {
                updateStats();
                showNotification('Элемент удален!');
            }
        }

        function copyScript(id) {
            const script = scriptsDB.find(s => s.id === id);
            if (script) {
                const textToCopy = `${script.model} | ${script.category}\n\n${script.title}\n\n${script.content}`;
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        copyStats.today++;
                        copyStats.total++;
                        copyStats.lastUpdate = new Date().toLocaleDateString('ru-RU');
                        localStorage.setItem('soykaCopyStats', JSON.stringify(copyStats));
                        updateStats();
                        showNotification('Скрипт скопирован в буфер обмена!');
                        
                        // Визуальная обратная связь
                        const card = document.querySelector(`.card[data-id="${id}"]`);
                        if (card) {
                            const btn = card.querySelector('.icon-btn.copy');
                            const originalColor = btn.style.color;
                            const originalBg = btn.style.background;
                            btn.style.background = 'var(--success)';
                            btn.style.color = 'white';
                            setTimeout(() => {
                                btn.style.background = originalBg;
                                btn.style.color = originalColor;
                            }, 500);
                        }
                    })
                    .catch(() => showNotification('Ошибка при копировании', 'error'));
            }
        }

        function copySetup(id) {
            const setup = setupsDB.find(s => s.id === id);
            if (setup) {
                const textToCopy = `${setup.brand} - ${setup.title}\nТип: ${setup.type}\n\nИнструкция:\n${setup.steps.map((step, i) => `${i+1}. ${step}`).join('\n')}`;
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        copyStats.today++;
                        copyStats.total++;
                        copyStats.lastUpdate = new Date().toLocaleDateString('ru-RU');
                        localStorage.setItem('soykaCopyStats', JSON.stringify(copyStats));
                        updateStats();
                        showNotification('Инструкция скопирована в буфер обмена!');
                    })
                    .catch(() => showNotification('Ошибка при копировании', 'error'));
            }
        }

        function exportScripts() {
            const dataStr = JSON.stringify(scriptsDB, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `soyka_scripts_${new Date().toISOString().slice(0,10)}.json`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showNotification('Скрипты экспортированы в JSON файл!');
        }

        function exportRouters() {
            const dataStr = JSON.stringify(routersDB, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `soyka_routers_${new Date().toISOString().slice(0,10)}.json`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showNotification('Роутеры экспортированы в JSON файл!');
        }

        function exportAllData() {
            const allData = {
                scripts: scriptsDB,
                routers: routersDB,
                setups: setupsDB,
                exportDate: new Date().toISOString(),
                totalItems: scriptsDB.length + routersDB.length + setupsDB.length
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `soyka_full_database_${new Date().toISOString().slice(0,10)}.json`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showNotification('Вся база данных экспортирована!');
        }

        function updateStats() {
            document.getElementById('totalScripts').textContent = scriptsDB.length;
            document.getElementById('totalRouters').textContent = routersDB.length;
            document.getElementById('totalSetups').textContent = setupsDB.length;
            document.getElementById('totalCopies').textContent = copyStats.today;
            document.getElementById('totalCopiesAll').textContent = copyStats.total;
            document.getElementById('lastUpdate').textContent = copyStats.lastUpdate;
            
            // Найти популярную категорию
            const categories = scriptsDB.reduce((acc, script) => {
                acc[script.category] = (acc[script.category] || 0) + 1;
                return acc;
            }, {});
            
            let popularCategory = 'Диагностика';
            let maxCount = 0;
            for (const [category, count] of Object.entries(categories)) {
                if (count > maxCount) {
                    maxCount = count;
                    popularCategory = category;
                }
            }
            document.getElementById('popularCategory').textContent = popularCategory;
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const icon = notification.querySelector('i');
            const text = document.getElementById('notificationText');
            
            notification.style.background = type === 'error' ? 'var(--danger)' : 
                                          type === 'warning' ? 'var(--warning)' : 'var(--success)';
            icon.className = type === 'error' ? 'fas fa-exclamation-circle' :
                            type === 'warning' ? 'fas fa-exclamation-triangle' : 'fas fa-check-circle';
            text.textContent = message;
            
            notification.style.display = 'flex';
            notification.style.animation = 'none';
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease';
            }, 10);
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        function showHelp() {
            alert("📚 База знаний Сойка - Справочная информация\n\n" +
                  "✨ Основные функции:\n" +
                  "• Скрипты поддержки - готовые ответы для клиентов\n" +
                  "• Каталог роутеров - информация об оборудовании\n" +
                  "• Инструкции - пошаговые руководства по настройке\n\n" +
                  "🛠️ Как использовать:\n" +
                  "1. Используйте поиск для быстрого нахождения\n" +
                  "2. Фильтруйте по категориям и параметрам\n" +
                  "3. Копируйте текст кнопкой 'Копировать'\n" +
                  "4. Добавляйте свои элементы через кнопку 'Добавить'\n\n" +
                  "💾 Все данные сохраняются автоматически!");
        }

        function showKeyboardShortcuts() {
            alert("⌨️ Горячие клавиши:\n\n" +
                  "Ctrl + F - Поиск на странице\n" +
                  "Ctrl + S - Сохранить (в форме)\n" +
                  "Esc - Закрыть модальное окно\n" +
                  "1 - Перейти к скриптам\n" +
                  "2 - Перейти к роутерам\n" +
                  "3 - Перейти к настройкам\n" +
                  "4 - Перейти к статистике\n" +
                  "+ - Добавить новый элемент");
        }

        function handleKeyboardShortcuts(e) {
            // Ctrl + комбинации
            if (e.ctrlKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        if (document.getElementById('scriptModal').style.display === 'flex') {
                            saveItem();
                        }
                        break;
                }
            }
            
            // Одиночные клавиши
            if (!e.ctrlKey && !e.altKey && !e.shiftKey) {
                switch(e.key) {
                    case 'Escape':
                        closeModal();
                        break;
                    case '1':
                        e.preventDefault();
                        switchSection('scripts');
                        break;
                    case '2':
                        e.preventDefault();
                        switchSection('routers');
                        break;
                    case '3':
                        e.preventDefault();
                        switchSection('setups');
                        break;
                    case '4':
                        e.preventDefault();
                        switchSection('stats');
                        break;
                    case '+':
                    case '=':
                        e.preventDefault();
                        openModal();
                        break;
                }
            }
        }

        // Закрытие модального окна при клике вне его
        window.onclick = function(event) {
            if (event.target === document.getElementById('scriptModal')) {
                closeModal();
            }
        };
    </script>
</body>
</html>
